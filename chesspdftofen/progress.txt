we dont need adaptive threshold because images are uniform so simple threshold

check largest contour for square using hough and square
-problem is squares might not be connected

png for 23 was 12:07 to 12:21 using 3 threads
jpg for 23 was 12:53 to 12:56 using 3 threads

train
linear
Wall time: 41.6 s
rbf
Wall time: 13min 56s
poly
Wall time: 52.8 s
sig
Wall time: 3min 32s

linear_pred = linear.predict(X_test)
Wall time: 17.2 s
poly_pred = poly.predict(X_test)
Wall time: 21.8 s
rbf_pred = rbf.predict(X_test)
Wall time: 52.2 s
sig_pred = sig.predict(X_test)  
Wall time: 53.3 s

0['BlackBishop', 
1'BlackKing', 
2'BlackKnight', 
3'BlackPawn', 
4'BlackQueen', 
5'BlackRook', 
6'BlackSpace', 
7'WhiteBishop', 
8'WhiteKing', 
9'WhiteKnight', 
10'WhitePawn', 
11'WhiteQueen', 
12'WhiteRook', 
13'WhiteSpace']

Accuracy Linear Kernel: 0.9981640146878825
Accuracy Polynomial Kernel: 0.9981640146878825
Accuracy Radial Basis Kernel: 0.9106487148102815
Accuracy Sigmoid Kernel: 0.4222766217870257
[[ 76   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  83   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  79   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  94   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  58   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  41   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0 299   0   0   0   0   0   0   3]
 [  0   0   0   0   0   0   0  73   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0  97   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0 107   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0 115   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  87   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  98   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0 324]]
[[ 76   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  83   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  79   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  94   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  58   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  41   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0 299   0   0   0   0   0   0   3]
 [  0   0   0   0   0   0   0  73   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0  97   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0 107   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0 115   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  87   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  98   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0 324]]
[[ 60   0   0   0   0   0   0   0   0   0   0   0   0  16]
 [  0  72   0   0   0   0   0   0   0   0   0   0   0  11]
 [  0   0  70   0   0   0   0   0   0   0   0   0   0   9]
 [  0   0   0  82   0   0   0   0   0   0   0   0   0  12]
 [  0   0   0   0  55   0   0   0   0   0   0   0   0   3]
 [  0   0   0   0   0  33   0   0   0   0   0   0   0   8]
 [  0   0   0   0   0   0 280   0   0   0   0   0   0  22]
 [  0   0   0   0   0   0   0  67   0   0   0   0   0   6]
 [  0   0   0   0   0   0   0   0  83   0   0   0   0  14]
 [  0   0   0   0   0   0   0   0   0  93   0   0   0  14]
 [  0   0   0   0   0   0   0   0   0   0  98   0   0  17]
 [  0   0   0   0   0   0   0   0   0   0   0  80   0   7]
 [  0   0   0   0   0   0   0   0   0   0   0   0  91   7]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0 324]]
[[  9   1   0   0   0   0  39  26   0   1   0   0   0   0]
 [  0   6   0   0   3   0  68   0   6   0   0   0   0   0]
 [  0   0   0   1   0   0  73   0   0   5   0   0   0   0]
 [  0   0   0   4   0   0  89   0   0   0   0   0   0   1]
 [  0   0   0   0  51   0   1   0   0   0   0   6   0   0]
 [  0   0   2   4   0   0   3   0   0   0   0  11  21   0]
 [  0   1  78   0   0   0 196   0   7   1   3   0   0  16]
 [  0   0   0   1   0   0  45  27   0   0   0   0   0   0]
 [  0   6   0   0   2   0  81   0   7   0   0   0   0   1]
 [  0   0   0   0   0   0  90   0   0  15   0   0   0   2]
 [  0   0   0   0   0   0 112   0   0   0   3   0   0   0]
 [  0   2   0   0  20   0  35   0   0   0   0  30   0   0]
 [  0   0   2   1   0   0   6   0   0   0   0   7  82   0]
 [  0   0   0   0   0   0  64   0   0   0   0   0   0 260]]

 28,032 Files training
 des - their dataset padding (3,3) no resize
winSize = (128, 128) #
blockSize = (64, 64) #
blockStride = (32, 32) #
cellSize = (16, 16) #
im = cv2.resize(im, (125, 125))
x = hog.compute(im, padding=(3,3))

 des2 - my dataset resize to 128x128
winSize = (128, 128) #
blockSize = (64, 64) #
blockStride = (32, 32) #
cellSize = (16, 16) #
im = cv2.resize(im, (128, 128))
x = hog.compute(im)

 des3 - my dataset with normal, gaussian, median blur
winSize = (128, 128) #
blockSize = (64, 64) #
blockStride = (32, 32) #
cellSize = (16, 16) #
im = cv2.resize(im, (128, 128))
x = hog.compute(im)

 des4 - my dataset with normal, gaussian, median blur with smaller windows
winSize = (128, 128) #
blockSize = (16, 16) #
blockStride = (8, 8) #
cellSize = (8, 8) #
im = cv2.resize(im, (128, 128))
x = hog.compute(im)

 des5 - my dataset with normal, gaussian, median blur with smaller windows and signed
winSize = (128, 128) #
blockSize = (16, 16) #
blockStride = (8, 8) #
cellSize = (8, 8) #
im = cv2.resize(im, (128, 128))
x = hog.compute(im)
signedGradients = True

des6 - my dataset with normal, gaussian, median blur with large windows and signed
winSize = (128, 128) #
blockSize = (64, 64) #
blockStride = (32, 32) #
cellSize = (16, 16) #
im = cv2.resize(im, (128, 128))
x = hog.compute(im)
signedGradients = True

 des3
linear
Wall time: 35.6 s

%%time
linear_pred = linear.predict(X_test)
Wall time: 15.2 s
Accuracy Linear Kernel: 1.0
[[ 413    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0  267    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  328    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1651    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  252    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  504    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  442    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  290    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  365    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1649    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  266    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  531    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4900]]


des2
linear
Wall time: 10.4 s

linear_pred = linear.predict(X_test)
Wall time: 3.34 s
Accuracy Linear Kernel: 1.0
[[ 132    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0   84    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  110    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0  537    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0   95    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  159    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 1647    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  126    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0   92    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  124    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0  550    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  100    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  161    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 1690]]

 des4
 linear
Wall time: 10min 21s
Accuracy Linear Kernel: 1.0
[[ 413    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0  267    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  328    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1651    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  252    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  504    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  442    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  290    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  365    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1649    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  266    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  531    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4900]]


 des5
 linear
Wall time: 9min 5s
linear_pred = linear.predict(X_test)
Wall time: 4min 15s
Accuracy Linear Kernel: 1.0
[[ 413    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0  267    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  328    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1651    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  252    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  504    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  442    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  290    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  365    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1649    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  266    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  531    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4900]]

 des6
 linear
Wall time: 31.9 s
linear_pred = linear.predict(X_test)
Wall time: 10.5 s
Accuracy Linear Kernel: 1.0
[[ 413    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0  267    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  328    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1651    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  252    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  504    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  442    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  290    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  365    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1649    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  266    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  531    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4900]]

############################################################################################################


 des - their dataset padding (3,3) no resize
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 448    1    0    6    0    0    0  132    0    1    1    1    0    0]
 [   2  409    0    0    0    0    0    0    7    0    0    1    0    0]
 [   0    1  508    8    0    0    0    0    4   19    0    1    0    0]
 [  14    1   11 1797    0    0   14    0  112   93  544    2    0    0]
 [   0    0    0    0  349    3    0    0    0    0    0   45    1    0]
 [   0    0    0    2    1  509    0    0    0    0    0   58  180    0]
 [   0    0    0    7    0    0 8252    0    0    0   16    0    0    0]
 [ 187    5    0    5    1   12    0  340    7    0    0    3    0    0]
 [  21  227    1    0    3    0    0    0  146    0    0   19    1    0]
 [   0    0    5    0    0    0    0    1   56  463    5    0    1    0]
 [   0   11   60  423    0   37    2    1   42   14 2006    0    0    0]
 [   0    0    0    0   56    0    0    0    0    0    0  343    0    0]
 [   0    0    0    0    0  294    0    0    0    0    0   40  421    0]
 [   0    0    0    0    0    0    0    0    0 4487    0    0    0 3509]]

[0.75932203, 0.97613365, 0.93900185, 0.69435858, 0.87688442,
 0.67866667, 0.99722054, 0.60714286, 0.3492823 , 0.87193974,
 0.77272727, 0.85964912, 0.55761589, 0.43884442]

accuracy 0.7271778042959427
total 26816.0
Wall time: 6min 22s

 des2 - my dataset resize to 128x128
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 588    0    0    0    1    0    0    0    0    0    0    1    0    0]
 [ 124  290    0    1    1    0    0    0    0    0    0    3    0    0]
 [   0    0  539    2    0    0    0    0    0    0    0    0    0    0]
 [  15    0    3 2542    0    0    0    0    0   28    0    0    0    0]
 [   0    0    0    0   53    0    0    0    0    0    0  345    0    0]
 [   1    0    0    0    0  748    0    0    0    0    0    0    1    0]
 [   0    0    0    0    0    0 8275    0    0    0    0    0    0    0]
 [ 107    0    0    0    0    1    0  451    1    0    0    0    0    0]
 [   1    4    0    0    3    0    0    2  405    0    0    3    0    0]
 [   0    0   22    6    0    0    0    0    0  503    0    0    0    0]
 [   0    0    1 2320   21    0    0    0    0   12  242    0    0    0]
 [   0    0    0    0   11    0    0    0    0    0    0  388    0    0]
 [   0    0    0    0    0  249    0    0    0    0    0    0  506    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.8773120525059666
total 26816
Wall time: 46.2 s

[0.99661017, 0.69212411, 0.99630314, 0.98222566, 0.13316583,
 0.99733333, 1.        , 0.80535714, 0.96889952, 0.9472693 ,
 0.09322034, 0.97243108, 0.67019868, 1.        ]

 des3 - my dataset with normal, gaussian, median blur
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 529    0    0    0    0    0    0   59    0    0    0    2    0    0]
 [ 122  295    0    0    0    0    0    0    0    0    0    2    0    0]
 [   0    0  535    2    0    0    0    0    0    4    0    0    0    0]
 [  14    0    3 2540    0    0    0    0    0   31    0    0    0    0]
 [   0    0    0    0   27    0    0    0    0    0    0  371    0    0]
 [   3    0    0    0    0  743    0    0    0    0    0    0    4    0]
 [   2    0    0    0    0    0 8273    0    0    0    0    0    0    0]
 [  28    0    0    0    0    0    0  530    1    0    0    0    1    0]
 [   0    3    0    0    0    0    0    2  406    0    0    7    0    0]
 [   1    0   26    5    0    0    0    0    0  499    0    0    0    0]
 [   1    0    1 2453   16    0    0    0    0   15  108    2    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  399    0    0]
 [   0    0    0    0    0   24    0    0    0    0    0    0  731    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.8804818019093079
total 26816
Wall time: 53.9 s
[0.89661017, 0.70405728, 0.98890943, 0.98145286, 0.0678392 ,
 0.99066667, 0.99975831, 0.94642857, 0.97129187, 0.93973635,
 0.04160247, 1.        , 0.96821192, 1.        ]

des4 - my dataset with normal, gaussian, median blur with smaller windows
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 587    0    2    0    1    0    0    0    0    0    0    0    0    0]
 [ 350   56    0    4    5    0    0    0    0    0    0    4    0    0]
 [   0    0  540    1    0    0    0    0    0    0    0    0    0    0]
 [  97    0  104 2377    7    0    0    0    0    2    1    0    0    0]
 [   0    0    0    0  229    0    0    0    0    0    0  169    0    0]
 [   3    0    1    0    0  746    0    0    0    0    0    0    0    0]
 [  20    0    0    4    0    0 8251    0    0    0    0    0    0    0]
 [ 157    0    0    0    1    1    0  400    0    0    0    1    0    0]
 [   0   11    0    0    1    0    0   11  371    0    0   24    0    0]
 [   1    0   53    3    0    0    0    0    0  474    0    0    0    0]
 [  15    0   37 1006   31    0    0    0    0    2 1505    0    0    0]
 [   0    0    0    0  110    0    0    0    0    0    0  289    0    0]
 [   1    0    2    0    0  270    0   26    0    0    0    2  454    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.905243138424821
total 26816
Wall time: 10min 15s
[0.99491525, 0.13365155, 0.99815157, 0.91846986, 0.57537688,
 0.99466667, 0.9970997 , 0.71428571, 0.88755981, 0.89265537,
 0.57973806, 0.72431078, 0.6013245 , 1.        ]

 des5 - my dataset with normal, gaussian, median blur with smaller windows and signed
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 578    0    0    0    5    0    0    7    0    0    0    0    0    0]
 [ 248   46    4    0  115    0    0    4    0    0    0    2    0    0]
 [   0    0  540    0    1    0    0    0    0    0    0    0    0    0]
 [ 208    0   63 2310    4    0    0    0    0    3    0    0    0    0]
 [   0    0    0    0  322    0    0    0    0    0    0   76    0    0]
 [  15    0    4    0    0  652    0   16    0    0    0    0   63    0]
 [   0    0    0    0    0    0 8275    0    0    0    0    0    0    0]
 [  38    0    0    0    1    2    0  517    0    0    0    2    0    0]
 [   1    3    0    0    0    0    0    9  366    0    0   39    0    0]
 [   1    0    0    0    3    0    0    0    0  524    2    1    0    0]
 [  44    0    0    0   33    0    0   17    0   64 2437    1    0    0]
 [   0    0    0    0  144    0    0    0    0    0    0  255    0    0]
 [   0    0    0    0    0    0    0   16    0    0    0   20  719    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.9523045942720764
total 26816
Wall time: 7min 13s

[0.97966102, 0.1097852 , 0.99815157, 0.89258114, 0.80904523,
 0.86933333, 1.        , 0.92321429, 0.87559809, 0.98681733,
 0.93875193, 0.63909774, 0.95231788, 1.        ]

des6 - my dataset with normal, gaussian, median blur with large windows and signed
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 589    0    0    0    0    0    0    0    0    0    0    1    0    0]
 [  62  352    0    0    0    0    0    4    0    0    1    0    0    0]
 [   0    0  537    2    0    0    0    0    0    2    0    0    0    0]
 [  23    0   28 2536    0    0    0    0    0    1    0    0    0    0]
 [   0    0    0    0  299    0    0    0    0    0    0   99    0    0]
 [   3    0    0    0    0  745    0    0    0    0    0    0    2    0]
 [   0    0    0    0    0    0 8275    0    0    0    0    0    0    0]
 [   3    0    0    0    0    0    0  555    1    0    0    0    1    0]
 [   0    0    0    0    0    0    0    7  408    0    0    1    2    0]
 [   1    0    0    0    0    0    0    1    0  524    5    0    0    0]
 [   1    0    0    0   12    0    0    3    0   42 2532    6    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  399    0    0]
 [   0    0    0    0    0    0    0    6    0    0    0    0  749    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.9880668257756563
total 26816
Wall time: 1min 48s

[0.99830508, 0.84009547, 0.99260628, 0.97990726, 0.75125628,
 0.99333333, 1.        , 0.99107143, 0.97607656, 0.98681733,
 0.97534669, 1.        , 0.99205298, 1.        ]

des6 
train
rbf
Wall time: 5min 18s
predict
Wall time: 38.1 s
1.0
[[ 413    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0  267    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  328    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1651    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  252    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  504    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  442    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  290    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  365    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1649    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  266    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  531    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4900]]

[[ 345    0    0    0    0    0    0    0    0    0    0    0    0  245]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0  419]
 [   0    0    4    0    0    0    0    0    0    0    0    0    0  537]
 [   0    0    0 1294    0    0    0    0    0    0    0    0    0 1294]
 [   0    0    0    0  263    0    0    0    0    0    0    0    0  135]
 [   0    0    0    0    0  396    0    0    0    0    0    0    0  354]
 [   0    0    0    0    0    0 6216    0    0    0    0    0    0 2059]
 [   0    0    0    0    0    0    0  402    0    0    0    0    0  158]
 [   0    0    0    0    0    0    0    0   68    0    0    0    0  350]
 [   0    0    0    0    0    0    0    0    0  436    0    0    0   95]
 [   0    0    0    0    0    0    0    0    0    0 1974    0    0  622]
 [   0    0    0    0   12    0    0    0    0    0    0  331    0   56]
 [   0    0    0    0    0    0    0    0    0    0    0    0  576  179]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
array([0.58474576, 0.        , 0.00739372, 0.5       , 0.66080402,
       0.528     , 0.75117825, 0.71785714, 0.16267943, 0.82109228,
       0.76040062, 0.82957393, 0.76291391, 1.        ])
accuracy 0.757048031026253
total 26816
Wall time: 2min 34s


train
poly
Wall time: 54.1 s
predict
Wall time: 16.7 s
1.0
[[ 413    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0  267    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  328    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1651    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  252    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  504    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  442    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  290    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  365    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1649    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  266    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  531    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4900]]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 586    0    0    0    0    0    0    0    0    0    0    0    0    4]
 [ 132  265    0    0    0    0    0    5    0    0    0    0    0   17]
 [   0    0  537    2    0    0    0    0    0    2    0    0    0    0]
 [   6    0    9 2504    0    0    0    0    0    0    0    0    0   69]
 [   0    0    0    0  334    0    0    1    0    0    0   63    0    0]
 [   5    0    0    0    0  737    0    0    0    0    0    0    0    8]
 [   0    0    0    0    0    0 8275    0    0    0    0    0    0    0]
 [   3    0    0    0    0    0    0  555    1    0    0    0    1    0]
 [   0    1    0    0    0    0    0   10  407    0    0    0    0    0]
 [   1    0    0    0    0    0    0    0    0  527    2    0    0    1]
 [   6    0    0    0    0    0    0    1    0   14 2552    0    0   23]
 [   0    0    0    0    0    0    0    0    0    0    0  399    0    0]
 [   0    0    0    0    0    0    0    5    0    0    0    0  750    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.985381861575179
total 26816
Wall time: 1min 3s
[0.99322034, 0.63245823, 0.99260628, 0.9675425 , 0.83919598,
       0.98266667, 1.        , 0.99107143, 0.97368421, 0.99246704,
       0.98305085, 1.        , 0.99337748, 1.        ]

[0.75932203, 0.97613365, 0.93900185, 0.69435858, 0.87688442,
 0.67866667, 0.99722054, 0.60714286, 0.3492823 , 0.87193974,
 0.77272727, 0.85964912, 0.55761589, 0.43884442]

0.99830508, 0.84009547, 0.99260628, 0.97990726, 0.75125628,
 0.99333333, 1.        , 0.99107143, 0.97607656, 0.98681733,
 0.97534669, 1.        , 0.99205298, 1.        ]

des7 - my dataset with normal, gaussian, median blur with large windows and signed
125, 125 with 3,3 padding

linear
Wall time: 6min 22s
pred
Wall time: 2min 13s
1.0
[[ 413    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0  267    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  328    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1651    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  252    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  504    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  442    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  290    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  365    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1649    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  266    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  531    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4900]]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 586    0    0    1    1    0    0    0    0    1    0    1    0    0]
 [  90  328    0    0    0    0    0    1    0    0    0    0    0    0]
 [   0    0  538    2    0    0    0    0    0    1    0    0    0    0]
 [   5    0   20 2562    0    0    0    0    0    1    0    0    0    0]
 [   0    0    0    0  363    0    0    0    0    0    0   35    0    0]
 [   3    0    0    0    0  747    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 8275    0    0    0    0    0    0    0]
 [   4    0    0    0    0    0    0  554    1    0    0    0    1    0]
 [   0    1    0    0    0    0    0   11  406    0    0    0    0    0]
 [   1    0    0    0    0    0    0    0    0  525    5    0    0    0]
 [   3    0    0    0    9    0    0    4    0   35 2543    2    0    0]
 [   0    0    0    0   48    0    0    0    0    0    0  351    0    0]
 [   0    0    0    0    0    0    0    6    0    0    0    0  749    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
 accuracy 0.9890736873508353
total 26816
Wall time: 6min 40s

 [0.99322034, 0.78281623, 0.99445471, 0.98995363, 0.9120603 ,
       0.996     , 1.        , 0.98928571, 0.97129187, 0.98870056,
       0.97958398, 0.87969925, 0.99205298, 1.        ]

des8 - my dataset with normal, gaussian, median blur with large windows and signed
128, 128 with 3,3 padding

linear
Wall time: 18min 56s
predict
Wall time: 1min 58s
Accuracy Linear Kernel: 1.0
[[ 413    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0  267    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  328    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1651    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  252    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  504    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  442    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  290    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  365    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1649    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  266    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  531    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4900]]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 589    0    0    0    0    0    0    0    0    0    0    1    0    0]
 [  83  332    0    0    0    0    0    4    0    0    0    0    0    0]
 [   0    0  538    1    0    0    0    0    0    2    0    0    0    0]
 [  23    0   16 2548    0    0    0    0    0    1    0    0    0    0]
 [   0    0    0    0  325    0    0    1    0    0    0   72    0    0]
 [   4    0    0    0    0  746    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 8275    0    0    0    0    0    0    0]
 [   6    0    0    0    0    0    0  552    1    0    0    0    1    0]
 [   0    0    0    0    0    0    0    9  407    0    0    1    1    0]
 [   2    0    0    0    0    0    0    0    0  526    3    0    0    0]
 [   4    0    0    0   14    0    0    5    0   35 2535    3    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  399    0    0]
 [   0    0    0    0    0    0    0    9    0    0    0    0  746    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.9887380668257757
total 26816
Wall time: 4min 58s

  [0.99830508, 0.79236277, 0.99445471, 0.98454405, 0.81658291,
       0.99466667, 1.        , 0.98571429, 0.97368421, 0.9905838 ,
       0.97650231, 1.        , 0.98807947, 1.        ]

template
same as des8
Accuracy Linear Kernel: 0.9010773401826484
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 538    0    0    1    0    0    0  175    0    0    7    0    0    0]
 [   0  438    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  297    2    0    0    0    0    0  266    0    0    0    0]
 [ 397    0    0 2289    0    1    0   97    0    0    0    0    0    0]
 [   0    0    0    0  396    0    0    0    0    0    0   39    0    0]
 [   0    0    0    0    0  813    0    0    0    0    0    0   23    0]
 [   0    0    0    0    0    0 8283    0    0    0    0    0    0    0]
 [ 156    0    0    0    0    0    0  335    0    0    6    0  195    0]
 [   0    7    0    0    0    0    0    0  335    0    0   96    0    0]
 [   0    0  386    0    0    0    0    0    0  180   10    0    0    0]
 [ 287    0    0    0  121    0    0  404    0    0 1933    0    0    0]
 [   0    0    0    0   77    0    0    0    0    0    0  354    0    0]
 [   0    0    0    0    0   20    0    0    0    0    0    0  822    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 8246]]
14 training sample

kmeans hog
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[   0    0  383    0  338    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  438    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0  565]
 [   0    0    0    0 1283 1389    0    0    0    0    0  112    0    0]
 [   0    0    0    0    0    0    0    0  435    0    0    0    0    0]
 [   0    0    0    0    0    0  836    0    0    0    0    0    0    0]
 [   0 8283    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  343    0  349    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  438    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0  576]
 [ 568    0    0    0 1462    0    0    0    0    0    0  715    0    0]
 [   0    0    0    0    0    0    0    0  431    0    0    0    0    0]
 [   0    0    0    0    0    0  842    0    0    0    0    0    0    0]
 [   0    0    0 1577    0    0    0 2658    0 1758  856    0 1397    0]]
[0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]

nearest neighbor
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 624    0    0    0    8    0    0   48    0    0   41    0    0    0]
 [   0  438    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  327    2    0    0    0    0    0  236    0    0    0    0]
 [  78    0    0 2302    0    0    0    0    0    0  404    0    0    0]
 [   0    2    0    0  431    0    0    0    1    0    0    1    0    0]
 [   0    0    0    0    0  819    0    0    0    0    0    0   17    0]
 [   0    0    0    0    0    0 8283    0    0    0    0    0    0    0]
 [   2    0    0    0    6    0    0  489    0    0   48    0  147    0]
 [   0    0    0    0    0    0    0    0  438    0    0    0    0    0]
 [   0    0   11    0    0    0    0    0    0  565    0    0    0    0]
 [   0    0    0   45    0    0    0    0    0    0 2700    0    0    0]
 [   0    3    0    0    0    0    0    0    0    0    0  428    0    0]
 [   0    0    0    0    0   20    0    0    0    0    0    0  822    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 8246]]
accuracy 0.9600456621004566
total 26912 28032
[0.86546463 1.         0.57876106 0.82686782 0.9908046  0.97966507
 1.         0.7066474  1.         0.98090278 0.98360656 0.99303944
 0.97624703 1.        ]



cnn
train on 23 test 1n
562.pth
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 518    2    0   11    4   53    0    2    0    0    0    0    0    0]
 [   0  341    1   51   26    0    0    0    0    0    0    0    0    0]
 [   0    7  493    4   37    0    0    0    0    0    0    0    0    0]
 [  16    0   22 2464    3   23    0   48    1    0    0   11    0    0]
 [   1    5   10   82  298    0    0    0    0    0    0    2    0    0]
 [  75    2    1   15    1  638    0   18    0    0    0    0    0    0]
 [   0    0    0    0    0    0 8275    0    0    0    0    0    0    0]
 [  22    0    0   24    0    0    3  468    3    0    0   39    1    0]
 [   0    0    0  323    0    0    1    6   68    0    0    0   20    0]
 [   0    0    0    0    0    0    6    0    1  498   13    0    2   11]
 [   0    0    0    0    0    0   95    0    0   81 2413    0    0    7]
 [   6    8    3    1  374    0    0    0    0    0    0    7    0    0]
 [   1    0    0   18    0    5   11    1   12    0    1    4  702    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.9389543556085919
total 25179 26816
[0.8779661 , 0.81384248, 0.91127542, 0.95208655, 0.74874372,
       0.85066667, 1.        , 0.83571429, 0.16267943, 0.93785311,
       0.92950693, 0.01754386, 0.92980132, 1.        ]

cnn without regularization
train on 23 test 1n
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 459    0    0   38    1   91    0    0    0    0    0    1    0    0]
 [   0  377    0   31   11    0    0    0    0    0    0    0    0    0]
 [   0    0  528   11    2    0    0    0    0    0    0    0    0    0]
 [  47    2   10 2514    7    7    0    1    0    0    0    0    0    0]
 [   2    1    0  194  200    0    0    0    0    0    0    1    0    0]
 [  43    0    0    3    0  699    0    0    0    0    0    5    0    0]
 [   0    0    0    0    0    0 8273    0    0    0    0    2    0    0]
 [  30    0    0    0    0    0    0  514    4    0    0    0   12    0]
 [   9    0    0    0    1    0    0  321   45    0    0    0   42    0]
 [   0    0    0    0    0    0   17    0    1  486   18    0    0    9]
 [   0    0    0    0    0    0   55    0    0   49 2473    0    0   19]
 [   7    4    0    0  379    0    0    0    0    0    0    9    0    0]
 [   5    0    0    0    1   20    4   22   10    0    0    7  686    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.9419376491646778
total 25259 26816
array([0.7779661 , 0.89976134, 0.97597043, 0.97140649, 0.50251256,
       0.932     , 0.99975831, 0.91785714, 0.1076555 , 0.91525424,
       0.95261941, 0.02255639, 0.90860927, 1.        ])

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 491    1    0   57    1   39    0    0    0    0    0    1    0    0]
 [   0  389    0   30    0    0    0    0    0    0    0    0    0    0]
 [   2    0  527   11    1    0    0    0    0    0    0    0    0    0]
 [  52    5    6 2519    3    3    0    0    0    0    0    0    0    0]
 [   4    2    1  210  181    0    0    0    0    0    0    0    0    0]
 [  48    1    0    6    0  693    0    1    0    0    0    1    0    0]
 [   0    0    0    0    0    0 8257    0    1    0    0   17    0    0]
 [  44    0    0    0    0    0    0  505    6    0    0    0    5    0]
 [  10    0    0    0    4    0    0  312   81    0    0    0   11    0]
 [   0    0    0    0    0    0    6    0    2  513    9    0    0    1]
 [   0    0    0    0    0    0   47    0    0   84 2461    0    0    4]
 [   7    6    0    0  384    0    0    0    0    0    0    2    0    0]
 [   6    0    0    0   12   14    1   32   18    0    0    9  663    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.9426461813842482
total 25278 26816
array([0.83220339, 0.92840095, 0.974122  , 0.97333849, 0.45477387,
       0.924     , 0.99782477, 0.90178571, 0.1937799 , 0.96610169,
       0.94799692, 0.00501253, 0.8781457 , 1.        ])

Net(
  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=2704, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

model2 
train on 23 test 1n more filters
Net(
  (conv1): Conv2d(1, 12, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(12, 24, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=4056, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 435    0    0   88    0   65    0    2    0    0    0    0    0    0]
 [   0  399    0   19    0    1    0    0    0    0    0    0    0    0]
 [   0    3  464   54    0   20    0    0    0    0    0    0    0    0]
 [  52    3   36 2489    1    5    0    2    0    0    0    0    0    0]
 [   0    1    0   23  374    0    0    0    0    0    0    0    0    0]
 [  53    0    5   45    0  636    0   11    0    0    0    0    0    0]
 [   0    0    0    0    0    0 8006    0    0    0    2  267    0    0]
 [ 148    0    0    0   14    2    0  368    7    0    0    0   21    0]
 [   0    1    0    0  181    0    0   17  169    0    0    0   50    0]
 [   0    0    0    0    0    0    5    0    3  515    7    0    1    0]
 [   0    0    0    0    0    0  110    0    0   40 2437    1    5    3]
 [   0    3    0    0  392    0    0    0    2    0    0    2    0    0]
 [   1    0    0    0   20    8    2    4   26    0    1    0  693    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 7996]]
accuracy 0.9316452863961814
total 24983 26816
array([0.73728814, 0.9522673 , 0.85767098, 0.96174652, 0.93969849,
       0.848     , 0.96749245, 0.65714286, 0.40430622, 0.96986817,
       0.93875193, 0.00501253, 0.91788079, 1.        ])

model3
train on 23 test 1n batchnorm
device cpu
Net(
  (conv1): Conv2d(1, 12, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (batch1): BatchNorm2d(12, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (batch2): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(12, 24, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=4056, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 413    0    0   77    1    0   90    3    0    0    0    1    2    3]
 [  37  223    9   10    4    0   76   45    0    0    7    8    0    0]
 [   1    0  485    2    3    0   27    0    0   15    4    4    0    0]
 [  28    0   27 2270    0    0  203    1    0    9    2   35    0   13]
 [   4    1   10   17  280    0   22    9    1    1    0   44    9    0]
 [  64    0   27   30    6  456  119    3    6    0    2   15   22    0]
 [  35    1    0    2   28    1 7585  142    0  146   43  273   19    0]
 [  64    1    0   13    0    0   73  405    1    0    1    2    0    0]
 [   4    5    0    5   12    0   72   39  272    2    1    2    4    0]
 [   0    0    0    0    0    0   40    0    0  480   11    0    0    0]
 [   6    0    0   11    0    0  112   32    0  128 2303    3    1    0]
 [   8    1   30    8  124    0   38    8    0    3    0  177    2    0]
 [   2    0    5    2    2    7   94    8    0    2   11    8  614    0]
 [  19    0    0    6    1   37 3555    0    0  329   51   56  225 3717]]
accuracy 0.733890214797136
total 19680 26816
[0.7       , 0.53221957, 0.89648799, 0.87712519, 0.70351759,
 0.608     , 0.91661631, 0.72321429, 0.6507177 , 0.9039548 ,
 0.88713405, 0.44360902, 0.81324503, 0.46485743]

model4 same as before except train on 1n test on 23
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 704    0    0    0    0    0    1   16    0    0    0    0    0    0]
 [   0  438    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  565    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 2779    0    0    2    0    0    0    3    0    0    0]
 [   0    0    0    0  432    0    0    0    2    0    0    1    0    0]
 [   0    0    0    0    0  820    0    0    0    0    0    0   16    0]
 [   0    0    0    0    0    0 8277    0    0    0    0    0    6    0]
 [   0    0    0    0    0    0    0  692    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  438    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  576    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 2745    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  431    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  842    0]
 [   0    0    0    0    0    0 6532    0    0   55    0    0  124 1535]]
accuracy 0.7589183789954338
total 21274 28032

model 5 same as model4 except train on both 1n and 23 for 0.8
Net(
  (conv1): Conv2d(1, 12, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (batch1): BatchNorm2d(12, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (batch2): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(12, 24, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=4056, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 120    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0   72    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  104    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0  486    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0   77    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  143    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 1538    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  122    1    0    0    0    1    0]
 [   0    0    0    0    0    0    0    0   88    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0   92    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0  485    0    0    0]
 [   0    0    0    0    2    1    0    0    0    0    0   76    0    0]
 [   0    0    0    0    0    0    0    0    0    1    0    0  138    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 1553]]
accuracy 0.9988235294117647
total 5094 5100
[1.        , 1.        , 1.        , 1.        , 1.        ,
   1.        , 1.        , 0.98387097, 1.        , 1.        ,
   1.        , 0.96202532, 0.99280576, 1.        ]


on gm
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 868    1    0    0    0    0    0  175    0    5  124    1    2    0]
 [   0  855    0    0    0    0    0   10    9    1    1    0    0    0]
 [   0    1  312    0    0    0    0    4    3   49  538    8    0    0]
 [  17    0    0 2384    0    0    0 2031    2    9 1059    0    1    0]
 [   0    0    0    0   71    0    0    3  434   23   58  148   17    0]
 [   0    0    0    0    0 1007    0    7  380    3   66    1  122    0]
 [   8    1    0    6    1    0  952 1498  683  998    6    0    4    0]
 [   0    0    0    0    0    0    0 1152    2    0    3    0    5    0]
 [   0    0    0    0    0    0    0   13  811    3    5    0   35    0]
 [   0    0    0    0    0    0    0    1    1  920    6    0    1    0]
 [   1    0    0    0    0    0    0    1    2   60 5413    3    4    0]
 [   1    0    0    0    0    3    0    1   25   14  127  551   41    0]
 [   0    0    0    8    0    0    0    8   26   17   48    0 1477    0]
 [  54    6    0    2   12    3 3382  105    3  332   29   24   54    0]]
accuracy 0.563570996572811
total 16773 29762
[0.73809524, 0.9760274 , 0.34098361, 0.43321824, 0.09416446,
       0.63493064, 0.22901131, 0.99139415, 0.93540946, 0.99031216,
       0.98705325, 0.72214941, 0.93244949, 0.        ]

on gm pil
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1147    0    0    0    0    0    0    8    0    5   15    0    1    0]
 [   0  868    0    0    0    0    0    3    0    5    0    0    0    0]
 [   4    8  829    2    0    0    0    0    3   51   15    3    0    0]
 [  14    1    0 5239    0    1    0   61    1   14  171    0    1    0]
 [   4    0    0    0  637    0    0    0   30   19    4   59    1    0]
 [   2    0    0    0    0 1234    0    4  265    1   55    0   25    0]
 [   0    0    0    0    0    1  293  220  212 2328  783  105  215    0]
 [   0    0    0    0    0    0    0 1153    7    0    1    0    1    0]
 [   0    0    0    0    0    0    0    8  841    5    0    0   13    0]
 [   0    0    0    0    0    0    0    0    0  927    2    0    0    0]
 [   1    0    0    0    0    0    0    0    1   40 5440    0    2    0]
 [   1    0    0    0    1    0    0    0    6    5   11  732    7    0]
 [   0    0    0    0    0    0    0    4    5   17    5    0 1553    0]
 [  22    6    0    0    2    5 3584   29    1  318   25    3   11    0]]
accuracy 0.7020025535918285
total 20893 29762
[0.97534014, 0.99086758, 0.90601093, 0.95202617, 0.84482759,
       0.77805801, 0.07048352, 0.99225473, 0.97001153, 0.99784715,
       0.99197666, 0.9593709 , 0.98042929, 0.        ]

on gm loader no gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1147    1    0    0    1    0    0    5    0    4   15    1    2    0]
 [   0  856    0    0    1    0    0   11    0    8    0    0    0    0]
 [   6    9  840    2    1    0    0    0    1   47    6    3    0    0]
 [  17    5    0 5282    0    1   12   64   10   30   82    0    0    0]
 [   4    1    0    0  631    0    0    0   29   14    8   67    0    0]
 [   2    0    0    0    0 1240    0   10  256    1   54    0   23    0]
 [   4    8    1    6   12    6 1314  304   78 1221  979  122  100    2]
 [   0    0    0    0    0    0    0 1153    4    0    1    2    2    0]
 [   0    0    0    0    0    0    0    9  827    4    0    0   27    0]
 [   0    0    0    0    0    0    1    0    0  924    3    1    0    0]
 [   2    0    0    0    0    0    1    0    1   53 5412    0   15    0]
 [   1    0    0    0    1    2    0    0    4    4   12  732    7    0]
 [   0    0    0    1    3    0    0    3    6    8    4    1 1558    0]
 [ 214    5    0    3    2    0 3207   38    0  452   24    4   12   45]]
accuracy 0.737887238760836
total 21961 29762

on gm loader gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1160    2    0    3    0    0    2    0    0    4    2    1    2    0]
 [   0  846    0    0    3    0   21    4    1    1    0    0    0    0]
 [  10    7  858   18    0    1    4    0    1    1   13    1    1    0]
 [   8    0    1 5403    0    0   25   30    0   22   14    0    0    0]
 [  24    7    1    0  624    0   66    0    1    2    5   24    0    0]
 [  67    0    0    2    1 1398   51    4   33    1   19    0   10    0]
 [  85    8    1    7    6    3 2862  102   20  222  257  215   42  327]
 [   7    0    0   22    1    0   12 1114    1    0    4    0    1    0]
 [   0    1    0    9    1    0    7    9  828    4    1    0    7    0]
 [   0    0    0    0    0    0   22    0    0  890    8    1    7    1]
 [   4    0    0    0    0    0   83    1    1   66 5310    0    8   11]
 [  13   12    1    0    6    5   30    0    4    4   21  663    2    2]
 [   1    0    0    3    2    7   34   16   18   16    5    2 1480    0]
 [ 179    6    0    4    1    4 3110   22    0   93   19    4   13  551]]
accuracy 0.8059606209260131
total 23987 29762

[0.98639456, 0.96575342, 0.93770492, 0.98182809, 0.82758621,
       0.8814628 , 0.68847727, 0.95869191, 0.9550173 , 0.95801938,
       0.96827133, 0.8689384 , 0.93434343, 0.13754368]

cnn6 with dropout
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 12, kernel_size=(5, 5), stride=(1, 1))
  (batch1): BatchNorm2d(12, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(12, 24, kernel_size=(5, 5), stride=(1, 1))
  (batch2): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (drop1): Dropout(p=0.5, inplace=False)
  (fc1): Linear(in_features=4056, out_features=120, bias=True)
  (drop2): Dropout(p=0.4, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)
train both 1n and 23
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 120    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0   72    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  104    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    1  485    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0   74    2    0    0    0    0    0    1    0    0]
 [   1    0    0    1    1  140    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 1537    0    0    0    1    0    0    0]
 [   0    0    0    0    0    0    0  122    1    0    0    0    1    0]
 [   0    0    0    0    0    0    0    0   87    0    0    0    1    0]
 [   0    0    0    0    0    0    0    0    0   92    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    1  484    0    0    0]
 [   0    0    0    0    2    0    0    0    0    0    0   77    0    0]
 [   0    0    0    0    0    0    0    1    0    0    0    1  137    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 1553]]
 accuracy 0.9968627450980392
total 5084 5100
[1.        , 1.        , 1.        , 0.99794239, 0.96103896,
       0.97902098, 0.9993498 , 0.98387097, 0.98863636, 1.        ,
       0.99793814, 0.97468354, 0.98561151, 1.        ]

on gm
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 978   16    2   18    1    7    0   13    1    3  137    0    0    0]
 [   3  840    0    1    7    0    0    1    0    1   23    0    0    0]
 [  19   40  318    2    4    4    0    0    0   45  478    3    2    0]
 [2915   17   14  609    1   64    0  587    4   29 1254    0    7    2]
 [   4   53    7    0  520   10    0    1   53   53   21   21    6    5]
 [  60    6    2    1    7 1228    0   13   31   13   62   30  132    1]
 [  59   58    2    7    7    5   72  237   61  160 1679   84   33 1693]
 [  12    0    0   25    0    1    0 1077    2    8   33    0    1    3]
 [   3   32   24    2    1    6    0   41  521   72   99    1   59    6]
 [   3    5    7    0   24    2    0    2    1  806   69    2    1    7]
 [  46   16    1    6    6    2    5   94    2   75 5159   16    1   55]
 [   2   16    9    0   31   95    0    0    7   22   18  519   37    7]
 [   3    4    1    0    7   40    0   16   39   40   54   10 1355   15]
 [ 296   23    1   10   12   18 1425   55   17  134  359   40   33 1583]]
accuracy 0.5236543243061622
total 15585 29762
[0.83163265, 0.95890411, 0.34754098, 0.11066691, 0.68965517,
       0.77427491, 0.01732018, 0.92685026, 0.60092272, 0.86759957,
       0.94073669, 0.6802097 , 0.85542929, 0.39515726]

on gm pil
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1133    4    3    4    4    4    1    4    1    4   10    2    1    1]
 [   0  872    0    0    1    0    0    0    0    1    2    0    0    0]
 [  20   24  799    6    5    2    0    0    1    0   55    3    0    0]
 [ 507    5    6 4696    0   15   12  186    3    4   50    6    2   11]
 [   0    7    0    0  648   39    0    0    5    3    5   46    1    0]
 [   6    3    2    4   17 1514    1    5    3    1    6    8   15    1]
 [  46   51    1    9    4    7   86  195   41  111 1810   78   36 1682]
 [  22    0    1   40    0    0    0 1079    2    1   14    0    2    1]
 [   0    2    2    0    0    0    0    5  749   37    8    2   61    1]
 [   0    1    3    0    0    4    1    0    2  876   36    0    5    1]
 [  20   14   13    2    1   10    2    1    1  162 5236   11    1   10]
 [   2    6    6    0   67   35    0    0    1    5   10  623    7    1]
 [   2    0    1    0    1   11    0    3   27   34   26    8 1470    1]
 [ 322   20    4   10   10   13 1659   64   11   68  286   19   47 1473]]
accuracy 0.7141321147772327
total 21254 29762

[0.96343537, 0.99543379, 0.87322404, 0.85335272, 0.85941645,
       0.95460277, 0.020688  , 0.92857143, 0.8638985 , 0.94294941,
       0.95477753, 0.81651376, 0.9280303 , 0.36769845]

on gm loader no gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1096    5    1   10    2    9    2    4    0    2    8    1    1   35]
 [   0  865    0    0    2    0    2    1    1    1    1    0    0    3]
 [  18   33  804   10    9    4    1    0    0    2   28    5    0    1]
 [ 417    4    4 4691    1   11   86  191    7   11   35    4    1   40]
 [   4    7    1    0  634   26    0    0    9    4    9   53    6    1]
 [   9    0    5    1   27 1499    5    2    2    3    9    9   13    2]
 [  59   15    1    9    5    7  673   91   14   58 1222   45   28 1930]
 [  16    1    0   60    0    0    1 1055    2    2   10    2    5    8]
 [   1   10    2    0    0    0    0    9  731   28   17    1   65    3]
 [   2    1    0    0    6    3    0    0    0  867   30    2    7   11]
 [   9   14   11    0   13    8    2    3    2  189 5124   31    6   72]
 [   3    6   10    0   70   32    7    0    1    5   12  612    4    1]
 [   1    1    0    1    1    9    1    5   26   45   30    8 1452    4]
 [ 116   11    6   16    4   13 1554   53    7   40  438   11   63 1674]]
accuracy 0.7317048585444527
total 21777 29762

[0.93197279, 0.98744292, 0.87868852, 0.85244412, 0.84084881,
       0.94514502, 0.1618956 , 0.90791738, 0.84313725, 0.93326157,
       0.93435449, 0.80209699, 0.91666667, 0.41787319]

om gm loader gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1081   14    0    6    2    2   14    5    0    3    1    0    0   48]
 [   1  861    0    0    0    0   11    0    2    0    0    0    0    1]
 [  13   32  822   21    1    2    3    1    0    0   12    3    0    5]
 [ 185    6    5 4990    2    3  128  104    2    4    4    1    1   68]
 [   6   78    2    0  584   10   35    0   11    0    1   24    0    3]
 [  25    2    2    2   18 1468   41    4    0    0    3    5    8    8]
 [ 110   32    6   22    8    9 1860   80   13   38  646  122   51 1160]
 [   5    0    1   45    3    0    6 1085    4    1    4    1    0    7]
 [   0    6    2    1    0    0   11   58  752   11    3    2   15    6]
 [   1    0    0    0    5    0    3    0    0  895   13    0    1   11]
 [   7    7    1    1    6    4   89    1    0   91 5133   16    3  125]
 [  12   32   10    0   66   27  107    1    2    2    3  501    0    0]
 [   1    1    0    0    2   12   39   19   60   33   16    3 1390    8]
 [ 114   10    5    8    9   15 1713   57    7   21  498    8   62 1479]]
accuracy 0.7694711376923594
total 22901 29762

[0.91921769, 0.98287671, 0.89836066, 0.90677812, 0.77453581,
       0.92559899, 0.44743806, 0.93373494, 0.86735871, 0.96340151,
       0.93599562, 0.65661861, 0.87752525, 0.36919621]

cnn7 lower the dropout from before
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 12, kernel_size=(5, 5), stride=(1, 1))
  (batch1): BatchNorm2d(12, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(12, 24, kernel_size=(5, 5), stride=(1, 1))
  (batch2): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=4056, out_features=120, bias=True)
  (drop2): Dropout(p=0.3, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 119    0    0    1    0    0    0    0    0    0    0    0    0    0]
 [   0   72    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  104    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0  486    0    0    0    0    0    0    0    0    0    0]
 [   0    0    1    0   76    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  143    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 1538    0    0    0    0    0    0    0]
 [   1    0    0    0    0    0    0  121    1    0    0    0    1    0]
 [   0    0    0    0    0    0    0    0   87    0    0    0    1    0]
 [   0    0    0    0    0    0    0    0    0   92    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0  485    0    0    0]
 [   0    0    0    0    0    1    0    0    0    0    0   78    0    0]
 [   0    1    0    0    0    0    0    0    0    0    0    0  138    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 1553]]
accuracy 0.9984313725490196
total 5092 5100

[0.99166667, 1.        , 1.        , 1.        , 0.98701299,
       1.        , 1.        , 0.97580645, 0.98863636, 1.        ,
       1.        , 0.98734177, 0.99280576, 1.        ]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 686   25    0   28    0    0    0  286    0    0  148    0    3    0]
 [   7  714    0    5    3    0    0   56   40    2   40    0    7    2]
 [  11  127  411    0    0    4    0    3  196    7  139   12    5    0]
 [ 144   40   36 2778    2    1    1 1361    9    1 1083    1   38    8]
 [   5   32    1    4  332   11    0   34   47   97   69   83   38    1]
 [ 117   25   54    9    4  857    0    6  160   43  178   41   92    0]
 [  59   47    0    1   11   32   26   85   33  695  825  232  404 1707]
 [   5    0    0    8    0    0    0 1070    6    0   63    0    8    2]
 [   7    3    1    6    0    1    0   32  579  104   84    0   50    0]
 [   0    0    0    0    0    1    0    0    1  860   43    1   23    0]
 [   2    1    0    0    0    2    0   16    5   51 5363    0   42    2]
 [  10   63    0    0   47    0    0   25   14   41   53  487   21    2]
 [   1    0    1    1    1   39    0    3   13  136   66    7 1315    1]
 [  25    7    0    9    8  358  733   22   21  465  184   13  256 1905]]
accuracy 0.5840669309858209
total 17383 29762

[0.58333333, 0.81506849, 0.44918033, 0.50481556, 0.4403183 ,
       0.54035309, 0.00625451, 0.92082616, 0.66782007, 0.92572659,
       0.97793581, 0.63826999, 0.83017677, 0.47553669]

on gm pil
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1125    1    0    9    1    3    0    6    0    2   28    0    0    1]
 [   2  868    0    0    3    0    0    1    0    1    1    0    0    0]
 [   4   11  818    1    3   13    0    0    3   12   44    5    1    0]
 [  29    1    3 4995    0    6    2  191    0    6  250    0   12    8]
 [  18    2    0    0  616   35    0    0    1   25   19   35    2    1]
 [  10    1    0    0    4 1476    0    1    3    9   68    1   12    1]
 [  56   53    0   13    6   16  107   90   28  721 1132  254  289 1392]
 [  38    1    0   24    0    0    0 1062    1    3   28    0    4    1]
 [   1    4    0    0    0    0    0    2  780   28    7   10   35    0]
 [   0    0    0    0    0    1    0    0    0  888   30    1    8    1]
 [   7    0    1    0    0    5    0    1    5   24 5432    0    9    0]
 [   8    2    0    0   51   19    0    0    4   35   14  626    3    1]
 [   4    0    0    0    0    6    0    3   25   88   38    2 1417    1]
 [  46   14    1   14    5  182  276   15   36  402  370   10  269 2366]]
accuracy 0.7585511726362476
total 22576 29762

[0.95663265, 0.99086758, 0.89398907, 0.90768672, 0.81697613,
       0.93064313, 0.02573972, 0.91394148, 0.89965398, 0.95586652,
       0.99051787, 0.82044561, 0.89457071, 0.59061408]

on gm loader no guass
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1094    0    0    7    0    4   28    4    0    4   17    0    1   17]
 [   4  860    0    0    1    0    6    1    1    1    1    0    0    1]
 [   7    7  816    1    5   17    0    0    5   11   30   14    1    1]
 [  57    0    2 4860    2   14  188  165    2    6  176    0   11   20]
 [  22    4    0    0  611   26    1    1    1   35   21   30    1    1]
 [  17    0    2    5    2 1445    9    0    1    7   85    3    9    1]
 [ 160   10    1   11    2   12 1455   17   21  277  636   73  111 1371]
 [  39    0    0   23    0    0    3 1067    2    7   14    0    5    2]
 [   1    9    0    0    1    0    0    2  777   23   19    2   32    1]
 [   1    1    1    0    0    1    1    0    0  878   34    1    9    2]
 [  29    1    3    5    2   21    6   15    1   38 5344    0   10    9]
 [  10    0    3    0   75   16    2    0    1   22   15  615    4    0]
 [   4    0    0    1    0   18    6    2   10  108   34    6 1395    0]
 [  85    3    8   21    8  130  782    1    3  205  169    6  326 2259]]
accuracy 0.7887910758685572
total 23476 29762

[0.95663265, 0.99086758, 0.89398907, 0.90768672, 0.81697613,
       0.93064313, 0.02573972, 0.91394148, 0.89965398, 0.95586652,
       0.99051787, 0.82044561, 0.89457071, 0.59061408]

on gm loader gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1099    1    0    3    1    4   22    1    0    2   12    0    1   30]
 [   0  860    0    0    1    0    8    3    2    0    0    0    0    2]
 [   5    6  870    4    2    8    4    0    1    3    5    5    1    1]
 [  27    0    7 5210    0   12   82   51    0    4   62    0    6   42]
 [   4    1    0    0  647   16   31    1    0    0    1   51    1    1]
 [   7    1    1    4    0 1422   62    0    0    1   67    0   11   10]
 [ 146    9    0   11    3   15 2173    4    5  112  234  172   73 1200]
 [  10    2    0   23    2    0   62 1049    3    0    2    0    1    8]
 [   3   11    0    3    0    0    8   20  777    9    5    2   22    7]
 [   1    0    0    0    0    0   39    0    1  850   23    1    6    8]
 [  15    1    0    0    1    8  280    7    1   30 5076    0    3   62]
 [   3   10    0    0   68    4   63    0    1    1    1  609    2    1]
 [   3    1    0    3    0   11   23   15   20   20   20    3 1461    4]
 [ 256    6    3   16    3   39 1279    7    7  247   27    7  216 1893]]
accuracy 0.8062630199583362
total 23996 29762

[0.93452381, 0.98173516, 0.95081967, 0.94675631, 0.85809019,
       0.89659521, 0.52273274, 0.90275387, 0.89619377, 0.91496233,
       0.92560175, 0.79816514, 0.92234848, 0.47254119]
cnn8
train 1n and 23 with dataaug
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 12, kernel_size=(5, 5), stride=(1, 1))
  (batch1): BatchNorm2d(12, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(12, 24, kernel_size=(5, 5), stride=(1, 1))
  (batch2): BatchNorm2d(24, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=4056, out_features=120, bias=True)
  (drop2): Dropout(p=0.3, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

2591575158016 Compose(
    Grayscale(num_output_channels=1)
    Resize(size=(64, 64), interpolation=PIL.Image.BILINEAR)
    <__main__.GaussianSmoothing object at 0x0000025B0C922460>
    RandomApply(
    p=0.5
    RandomResizedCrop(size=(64, 64), scale=(0.8, 1.0), ratio=(0.9, 1.1), interpolation=PIL.Image.BILINEAR)
)
    ToTensor()
    <torchvision.transforms.transforms.RandomErasing object at 0x0000025B0C922FD0>
)
2590076185856 Compose(
    Grayscale(num_output_channels=1)
    Resize(size=(64, 64), interpolation=PIL.Image.BILINEAR)
    <__main__.GaussianSmoothing object at 0x0000025B0C9222E0>
    ToTensor()
)

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 119    0    0    0    0    0    0    1    0    0    0    0    0    0]
 [   1   78    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  112    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0  497    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0   61    0    0    0    0    0    0    0    0    0]
 [   0    0    0    1    0  172    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 1486    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  114    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0   67    1    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  111    2    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0  509    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0   73    0    0]
 [   0    0    0    0    0    1    0    0    0    0    0    0  157    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 1537]]
accuracy 0.9986274509803922
total 5093 5100

[0.99166667, 0.98734177, 1.        , 1.        , 1.        ,
       0.99421965, 1.        , 1.        , 0.98529412, 0.98230088,
       1.        , 1.        , 0.99367089, 1.        ]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 670   20    0    3    0    0    0   95    0    2  371    0    9    6]
 [   3  488    0    1    0    0    0   44  157    3  160    0   17    3]
 [  16  127  460    1    1    1    0    2  136   34  129    4    1    3]
 [ 311   30    8 1939    0    6    0  609   14   10 2466    2   49   59]
 [   3   34    0    1  293    3    0   13   83  187   46   88    3    0]
 [  46   11   13    0   19  827    0    7  246   60  142   66  134   15]
 [   0    6    0    1    1    1   73   49   22  305  990   28  156 2525]
 [   6    1    0    2    0    0    0  943    3    1  198    0    5    3]
 [   0    2    0    1    0    0    0   43  541  144  119    0   14    3]
 [   0    0    0    0    0    0    0    0    1  876   34    1   15    2]
 [   0    0    0    0    0    0    0    7    1   16 5454    1    1    4]
 [   4   46    0    0   14    2    0   11   24   45   63  542    7    5]
 [   0    0    0    0    0   24    0   13   11  176  115    4 1225   16]
 [  20    4    0    2    7   58 1050   34   15  233  196   22  383 1982]]
accuracy 0.5481150460318527
total 16313 29762

[0.56972789, 0.55707763, 0.50273224, 0.35235326, 0.38859416,
       0.52143758, 0.01756074, 0.81153184, 0.62399077, 0.94294941,
       0.99452954, 0.71035387, 0.77335859, 0.49475786]

gm on pil
    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1100    6    0    1    1    2    0   12    1    3   44    0    1    5]
 [   1  855    0    0    3    0    1    3    3    4    0    0    1    5]
 [   0   17  828    5    3    1    0    0    5   24   25    5    1    1]
 [  29    2    2 4974    0    3    0  100    0    2  369    0    3   19]
 [   0    0    0    0  641    3    0    1    1   24   42   32    3    7]
 [  15    0    0    3    8 1442    0    2   16   15   54    3   21    7]
 [   6    5    0    3    0    2  221   37   14  217 1235   43   64 2310]
 [  10    1    0    1    0    0    0  975    1    6  164    0    0    4]
 [   0    0    0    1    0    1    0    2  790   37   11    1   22    2]
 [   0    0    0    0    0    0    0    0    0  885   40    0    3    1]
 [   0    0    0    0    0    2    0    2    0    7 5463    0    5    5]
 [   2    3    0    0   48    4    0    1    5   33   20  637    2    8]
 [   0    0    0    0    1    4    0    0   14   38  137    1 1385    4]
 [  32    6    1    4    4   34  385   36   13  303  159    4  150 2875]]
accuracy 0.7751831194140179
total 23071 29762

[0.93537415, 0.9760274 , 0.90491803, 0.90387062, 0.85013263,
       0.90920555, 0.05316334, 0.83907057, 0.911188  , 0.95263724,
       0.99617068, 0.83486239, 0.87436869, 0.71767349]

gm loader no gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 987    2    0    1    0    1   60   25    1    9   28    0    2   60]
 [   1  822    0    0    0    0   27   12    1    3    2    0    2    6]
 [   1   14  858    2    0    2    1    0    1   19   14    1    0    2]
 [  26    0    1 5035    0   11   98   71    2   10  183    0   11   55]
 [   2    0    0    0  640    6    5    1    0   22   31   31   10    6]
 [  12    1    0    0    4 1416   36    1   11   15   44    6   28   12]
 [ 149    0    0    8    4    5 1616   81   17  107  560   15   39 1556]
 [  14    0    0    4    0    0    8  988    2    8   94    0    5   39]
 [   1    3    0    0    0    1    0    2  770   32   20    2   29    7]
 [   3    1    0    0    0    0    0    0    0  882   31    0    4    8]
 [   2    0    1    2    0    2    1    6    1    7 5443    0    2   17]
 [   4    2    0    0   38    2    7    1    7   22   12  659    6    3]
 [   1    0    0    2    0   10   10    4   10   73  104    2 1359    9]
 [  64    4    2   16    6   41 1387   22   10  216  187    6  234 1811]]
accuracy 0.7824070962972919
total 23286 29762

[0.83928571, 0.93835616, 0.93770492, 0.91495548, 0.84880637,
       0.89281211, 0.38874188, 0.85025818, 0.88811995, 0.94940797,
       0.99252371, 0.86369594, 0.85795455, 0.45207189]

gm loader gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 923    0    0    3    0    1   69   10    0    2    7    1    2  158]
 [   0  747    0    0    1    0   35    4    3    0    0    0    0   86]
 [   1    3  866    7    3    3    7    0    1    7   10    0    0    7]
 [  11    1    1 5121    0    2   61   96    0    6   65    1    9  129]
 [   0    6    0    0  569    3   14    1    1    2    1   42    3  112]
 [   0    0    0    1    0 1196  125    0    0    1   23    4   15  221]
 [ 204    2    0    9    6    9 2380  107    4   52  229  127   81  947]
 [   4    0    0   11    1    0   43 1035    1    0   25    0    2   40]
 [   1    3    0    0    0    0    4    5  757   12    4    0    5   76]
 [   1    0    1    0    0    1   12    0    0  873   12    0    1   28]
 [   1    1    0    2    0    0  120    0    0   11 5289    1    1   58]
 [   0    1    0    0   41    1   95    1    2    0    5  532    0   85]
 [   0    0    0    1    0    9   17    4    7   16   33    1 1404   92]
 [ 376    6    1   11    2   11 1700   39    1  283   96   11  282 1187]]
accuracy 0.7687319400577918
total 22879 29762

[0.78486395, 0.85273973, 0.94644809, 0.93058332, 0.75464191,
       0.75409836, 0.57252827, 0.89070568, 0.87312572, 0.93972013,
       0.96444201, 0.69724771, 0.88636364, 0.29630554]

cnn9 more filters
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(16, 32, kernel_size=(5, 5), stride=(1, 1))
  (batch2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=5408, out_features=120, bias=True)
  (drop2): Dropout(p=0.3, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 119    0    0    0    0    0    0    1    0    0    0    0    0    0]
 [   0   79    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    1  111    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0  497    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0   59    1    0    0    1    0    0    0    0    0]
 [   0    0    0    1    0  169    0    0    0    0    0    1    2    0]
 [   0    0    0    0    0    0 1486    0    0    0    0    0    0    0]
 [   0    1    0    0    0    0    0  113    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0   68    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  111    2    0    0    0]
 [   0    0    0    0    0    0    2    0    0    0  507    0    0    0]
 [   0    0    0    0    2    0    0    0    0    0    0   71    0    0]
 [   0    0    0    0    0    1    0    0    0    0    1    0  156    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 1537]]
accuracy 0.9966666666666667
total 5083 5100

[0.99166667, 1.        , 0.99107143, 1.        , 0.96721311,
       0.97687861, 1.        , 0.99122807, 1.        , 0.98230088,
       0.99607073, 0.97260274, 0.98734177, 1.        ]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 983    1    0    0    0    4    0   34    0    8  107    0    0   39]
 [   6  737    0    0    0    0    0   20   11   10   46    0    0   46]
 [ 136  180  184    8    7    9    0   10   18   14  275    2    0   72]
 [ 987    2    0 1609    0   19    0 2550    1   22  168    4   17  124]
 [  29   42    0    0  204    2    0   10  118   40   77   52    5  175]
 [  18    0    0    0    1  954    0   64   27   18  307    0   68  129]
 [  61    2    1    0    0    2    0   77    0  119  750   17   23 3105]
 [  18    0    0    0    0    0    0  866    0    4  236    0    2   36]
 [   0    0    0    0    0    0    0   28  484   74   30    0   48  203]
 [   0    0    0    0    0    0    0    0    1  829   52    0    2   45]
 [  21    0    0    0    0    3    0    2    0    9 5373    0    0   76]
 [   3    2    0    0    3    4    0    3    3    5   19  383    3  335]
 [   0    0    0    1    0    2    0   21    8   80   89    1 1255  127]
 [ 131   11    2    3    0   18  671  120    6  203  876   13  275 1677]]
accuracy 0.522075129359586
total 15538 29762
[0.83588435, 0.8413242 , 0.2010929 , 0.29238597, 0.27055703,
       0.60151324, 0.        , 0.74526678, 0.55824683, 0.89235737,
       0.9797593 , 0.50196592, 0.79229798, 0.41862207]

gm pil
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1131    1    0    2    1    1    0   15    1    5   15    1    1    2]
 [   0  855    0    0    2    0    0   11    1    4    0    0    2    1]
 [  11   10  813    5    1    5    0    0    2    3   56    2    1    6]
 [ 168    5    3 4880    0    6   10  297    0   12   76    1    5   40]
 [   9   10    1    0  619    1    0    3   53    1    0   32    9   16]
 [   0    0    0    0    1 1462    0    5    4    5   47    3   53    6]
 [  76    4    1    1    1   18    5   78    2  105  794   12   37 3023]
 [  11    0    0    3    0    0    0 1097    0    5   32    0    6    8]
 [   0    3    0    0    0    0    0   38  699   21    6    0   90   10]
 [   0    0    0    0    0    1    0    0    1  888   34    0    3    2]
 [   7    0    0    0    0    0    0    2    0   14 5443    0    0   18]
 [   5    2    3    1   55    5    0    1    4    4    4  593    5   81]
 [   0    0    0    0    0    3    0   21    7   27   45    1 1459   21]
 [ 394   12    0    2    0   26 1118  277    2  127  559    4  238 1247]]
accuracy 0.712015321550971
total 21191 29762

[0.96173469, 0.9760274 , 0.88852459, 0.88678902, 0.82095491,
       0.92181589, 0.00120279, 0.94406196, 0.80622837, 0.95586652,
       0.99252371, 0.77719528, 0.92108586, 0.31128308]

gm loader no gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1108    0    0    1    0    7    0   12    0    6   19    1    1   21]
 [   0  853    0    1    1    0    1   13    3    2    0    0    2    0]
 [  15    8  826    3    0    3    0    2    3    9   36    1    0    9]
 [ 151    5    3 4672    0    7   80  347    4   17   43    1   31  142]
 [   8   10    0    0  621    0    0    2   45    3    1   44    4   16]
 [   3    0    1    2    0 1433    0   16    4    2   56    3   47   19]
 [ 225    4    0    7    1    6  567  162    3   78  598   17   75 2414]
 [  10    0    0    7    0    0    0 1089    0    1   31    0   10   14]
 [   2    1    0    1    0    0    0   36  672   23   11    1   83   37]
 [   1    0    0    0    1    0    0    0    0  885   25    0    3   14]
 [   7    1    0    1    0    2    0    0    0   18 5408    0    0   47]
 [   5    6    9    0   52    7    1    1    4    4    9  600    1   64]
 [   1    0    0    0    0    4    0   30    7   30   44    1 1436   31]
 [ 387    1    1   10    3   18 1217  156    3   66  293    5  430 1416]]
accuracy 0.7252872790807069
total 21586 29762

[0.94217687, 0.97374429, 0.90273224, 0.84899146, 0.82360743,
       0.9035309 , 0.13639644, 0.93717728, 0.77508651, 0.95263724,
       0.9861415 , 0.78636959, 0.90656566, 0.3534698 ]

gm loader gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1129    1    0    1    0    4    1   14    1    3    3    1    0   18]
 [   0  858    0    0    0    0    6    4    1    1    0    0    0    6]
 [   6    1  846   11    0    0    5    0    0    4   40    0    0    2]
 [  35    0    0 5083    0    0  104  148    1   12   13    1    3  103]
 [   7   29    0    0  593    3   37    3   14    0    3   47    0   18]
 [  22    0    0    3    2 1445   38    7    1    1   34    0   16   17]
 [ 141    4    0   12    2   11 1748  271    9   83  439   74  145 1218]
 [   9    0    0    8    0    0   37 1086    1    0    5    0    3   13]
 [   0    5    0    2    0    0   11   20  780   10    1    2   20   16]
 [   1    0    0    0    0    3   10    0    2  888    8    1    5   11]
 [  17    0    0    1    0    8  141    0    1   17 5235    2    1   61]
 [   8    4    2    0   44   15  127    0    3    0    0  512    1   47]
 [   1    0    0    2    0   14   55   10   28   12   13    1 1421   27]
 [ 379    6    2    9    2    8 1584   98    1   32  285    2  367 1231]]
accuracy 0.7679255426382635
total 22855 29762

[0.96003401, 0.97945205, 0.92459016, 0.92367799, 0.78647215,
       0.9110971 , 0.42049555, 0.93459552, 0.89965398, 0.95586652,
       0.95459519, 0.67103539, 0.89709596, 0.30728907]

cnn10 train on 1n 23 gm
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 303    0    0    0    1    0    1    1    0    0    1    0    0    1]
 [   0  173    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  254    1    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1302    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  183    2    0    0    0    0    0    2    0    0]
 [   0    0    0    0    0  381    0    0    0    0    0    0    1    0]
 [   0    0    0    0    0    0 2455    1    0    0    0    0    0    1]
 [   0    0    0    0    0    0    0  293    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  188    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  238    0    1    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1320    0    0    0]
 [   0    0    0    0    3    0    0    0    0    0    0  176    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  402    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 2415]]
accuracy 0.9983168316831683
total 10083 10100
[0.98376623, 1.        , 0.99607843, 1.        , 0.97860963,
       0.9973822 , 0.999186  , 1.        , 1.        , 0.9958159 ,
       1.        , 0.98324022, 1.        , 1.        ]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1016    0    0    0    0    2    0   10    0    7   52    0    0   89]
 [  17  827    0    0    0    0    0    5    4    0    6    0    0   17]
 [ 117  157  353   61    0    1    0   13   11   11  119    0    1   71]
 [ 861    1    0 2219    0    2    0 2251    0    5   49    0    0  115]
 [  44   17    0    0  265    0    0    3  124    3   35   31    0  232]
 [  60    0    0    0    0 1223    0   35    1    6   66    1   74  120]
 [ 189    4    1    2    1    3   33  110    2   62  155    5    6 3584]
 [  28    0    0    0    0    0    0 1040    0    2   60    0    1   31]
 [   0    0    0    1    0    0    0   24  716   10    8    1   14   93]
 [   1    0    0    1    0    0    0    1    0  847   25    0    2   52]
 [ 102    0    0    0    0    8    0    2    0    7 5205    0    4  156]
 [   1    0    0    0    7    1    0    0   10    1    2  539    0  202]
 [   2    0    1    1    2    2    0   14    3   18   25    0 1334  182]
 [ 356    5    3    2    1   14 1104  112    2   52   65   12  104 2174]]
accuracy 0.5977756871178013
total 17791 29762

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1016    0    0    0    0    0    0    9    0    5   62    0    0   84]
 [  21  819    0    0    0    0    0   10    2    1    9    0    0   14]
 [ 119  143  359   65    0    1    0   13    6   13   99    1    1   95]
 [ 855    2    0 2232    1    1    0 2233    0    4   58    0    2  115]
 [  29   19    0    0  299    0    0    4  101    2   48   39    0  213]
 [  69    0    0    0    0 1218    0   32    1    6   78    1   67  114]
 [ 202    1    3    1    0    0   34  118    0   55  153    8    7 3575]
 [  27    0    0    1    0    0    0 1061    0    2   41    0    0   30]
 [   0    0    0    1    0    0    0   25  707   11    6    0   21   96]
 [   1    0    0    0    0    0    0    1    0  848   27    0    0   52]
 [ 102    0    0    0    0    5    0    1    0    8 5207    0    3  158]
 [   1    0    0    0    9    0    0    0    4    0    1  525    0  223]
 [   1    0    0    2    0    6    0   21    2    7   27    0 1338  180]
 [ 307    6    1    1    1   17 1057  120    3   47   93    6   89 2258]]
accuracy 0.602143673140246
total 17921 29762

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1043    0    0    0    0    0    0   14    0    3   51    0    0   65]
 [  10  849    0    1    0    0    1    5    0    1    0    0    1    8]
 [  55  100  429  131    1    0    0   11   14   15   99    1    3   56]
 [ 659    0    0 2433    0    4    0 2234    0    6   73    0    1   93]
 [  33   34    1    0  266    1    0    3  111    3   52   50    0  200]
 [  71    0    0    0    0 1240    0   41    0    3   59    1   72   99]
 [ 240    4    2    4    0    3   79  154    0   73  228   14    8 3348]
 [  28    0    0    0    0    0    0 1076    0    2   22    0    1   33]
 [   0    0    0    3    0    0    0   14  775    9    5    0   14   47]
 [   3    0    0    0    0    0    0    1    0  863   24    0    2   36]
 [  83    0    0    0    0    1    0    3    0    9 5300    0    4   84]
 [   0    0    0    0   10    1    0    0    9    0    0  620    0  123]
 [   0    0    0    1    0    3    0   15    2   16   26    0 1354  167]
 [ 379    5    0    2    0   18 1147   89    1   19   45    6  121 2174]]
accuracy 0.6216316107788455
total 18501 29762

[0.86394558, 0.94406393, 0.38579235, 0.4032346 , 0.35145889,
       0.77112232, 0.00793842, 0.89500861, 0.82583622, 0.91173305,
       0.94912473, 0.70642202, 0.84217172, 0.54268597]

trainset loader
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 1042     0     0     5     0     0     0     2     0     0     1     0 0     0]
 [    0   676     0     1     1     0     0     0     0     0     0     1 0     0]
 [    0     0   903     2     0     0     0     0     0     0     0     0 0     0]
 [    0     0     0  4271     1     0     0     0     0     0     0     0 0     0]
 [    1     0     1     0   642     0     0     0     0     0     0     0 0     0]
 [    2     0     0     4     0  1273     0     1     0     0     0     0 23     0]
 [    0     0     0     0     0     0 13288     0     0     0     0     0 0     0]
 [    2     0     0     0     0     0     0   997     2     0     1     0 1     0]
 [    0     0     0     0     0     0     0     0   675     0     0     0 1     0]
 [    0     0     0     0     0     0     0     0     0   885     5     0 0     0]
 [    0     0     0     0     0     0     0     0     0     1  4268     0 0     0]
 [    0     0     0     0    10     0     0     0     2     0     0   656 0     0]
 [    0     0     0     0     0     0     0     1     0     0     0     0 1277     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0 0 12953]]
accuracy 0.9983590865581841
total 43806 43878

[0.99238095, 0.99558174, 0.99779006, 0.99976592, 0.99689441,
       0.97697621, 1.        , 0.99401795, 0.99852071, 0.99438202,
       0.99976575, 0.98203593, 0.99921753, 1.        ]

testset loader
       0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 259    0    0    2    0    0    0    0    0    0    0    0    0    0]
 [   0  177    0    1    0    0    0    0    0    0    0    0    0    0]
 [   0    0  199    2    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1100    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  187    0    0    1    0    0    0    1    0    0]
 [   1    0    0    1    0  276    0    1    0    0    0    0    4    0]
 [   0    0    0    0    0    0 3270    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  249    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  179    0    0    1    0    0]
 [   0    0    0    0    0    0    0    0    0  217    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1072    0    0    0]
 [   0    0    0    0    8    0    0    0    0    0    0  154    0    0]
 [   0    0    0    0    1    0    0    0    0    0    0    0  318    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 3289]]
accuracy 0.9978122151321787
total 10946 10970

[0.99233716, 0.99438202, 0.99004975, 1.        , 0.98941799,
       0.97526502, 1.        , 1.        , 0.99444444, 1.        ,
       1.        , 0.95061728, 0.9968652 , 1.        ]


23
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 696    0    0    0    0    0    0   24    0    0    0    0    0    1]
 [   1  435    0    0    0    0    0    2    0    0    0    0    0    0]
 [   6    5  537    1    0    0    0    0    0    2   14    0    0    0]
 [   8    0    0 2494    0    0    0  265    0    0    2    0    0   15]
 [   1    0    0    0  420    0    0    0    4    0    0    1    0    9]
 [   0    0    0    1    0  782    0    4    0    0    0    0   49    0]
 [ 125    0    0    0    0    1  105    0    0    7   25    0    9 8011]
 [   0    0    0    0    0    0    0  692    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  434    0    0    0    1    3]
 [   0    0    0    0    0    0    0    0    0  571    0    0    0    5]
 [   4    0    0    0    0    0    0    0    0    0 2735    0    1    5]
 [   0    0    0    0    2    0    0    0    0    0    0  417    0   12]
 [   0    0    0    0    0    2    0    0    0    0    0    0  839    1]
 [ 252    3    2    5    7   18 4283   28    3   33  184   44  437 2947]]
accuracy 0.5031392694063926
total 14104 28032
[0.96532594, 0.99315068, 0.95044248, 0.89583333, 0.96551724,
       0.9354067 , 0.01267657, 1.        , 0.99086758, 0.99131944,
       0.99635701, 0.9675174 , 0.99643705, 0.3573854 ]

1n testloader
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 469    0    0    5    0    0    0    0    0    0    0    0    0    0]
 [   1  326    0    0    0    0    0    0    2    0    0    0    0    0]
 [   0    0  421    3    0    0    0    0    0    0    0    0    0    0]
 [   0    0    1 2059    0    0    0    0    0    0    0    0    0    0]
 [   0    1    0    0  319    1    0    0    0    0    0    1    0    0]
 [   1    0    0    4    0  593    0    0    0    0    0    0    4    0]
 [   0    0    0    0    0    0 6611    0    0    0    0    0    0    0]
 [   1    0    0    0    0    0    0  441    1    0    0    1    2    0]
 [   0    0    0    0    0    0    0    0  325    1    0    0    3    0]
 [   0    0    0    0    0    0    0    0    0  406    4    0    1    0]
 [   0    0    0    0    0    0    0    0    0    1 2102    0    0    0]
 [   0    0    0    0   15    0    0    0    1    0    0  301    0    0]
 [   0    0    0    0    0    1    0    0    0    0    0    1  594    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 6428]]
accuracy 0.9973429050904344
total 21395 21452


23 loader
    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 720    0    0    0    0    0    0    1    0    0    0    0    0    0]
 [   0  438    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  565    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 2784    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  435    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  826    0    0    0    0    0    0   10    0]
 [   0    0    0    0    0    0 8283    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  692    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  438    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  576    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    1 2744    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  431    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0  842    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 8246]]
accuracy 0.9995719178082192
total 28020 28032

pil
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1162    1    1    2    0    2    0    1    0    0    2    0    0    5]
 [   0  869    0    0    0    0    0    2    1    0    0    0    1    3]
 [   7   10  835    8    0    0    0    1    1   39   10    0    0    4]
 [  78    0    0 5149    0    1    0  257    1    1   11    0    0    5]
 [   6    1    0    0  696    0    0    1   21    1    0   14    0   14]
 [   6    0    0    0    0 1515    0    0    0    2    7    0   51    5]
 [ 147   11    3    2    0    6   27   99    3   74  137   17    9 3622]
 [  10    0    0    3    0    0    0 1135    0    0    8    0    0    6]
 [   0    0    0    0    1    0    0   14  827    1    0    0   19    5]
 [   0    0    1    0    0    0    0    0    0  916    5    0    0    7]
 [  10    0    0    0    0    5    0    1    0    7 5446    0    2   13]
 [   2    0    1    0  130    6    1    0    2    0    0  576    0   45]
 [   1    0    0    0    0    3    0    3    2    1    6    0 1521   47]
 [ 504    4    1    5    2   23 1186   79    1   19   42    3  163 1974]]
accuracy 0.7609703648948324
total 22648 29762
[0.98809524, 0.99200913, 0.91256831, 0.93567145, 0.92307692,
       0.95523329, 0.00649507, 0.9767642 , 0.9538639 , 0.98600646,
       0.99307075, 0.75491481, 0.96022727, 0.49276086]

gm using testloader no gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1132    1    0    0    0    0    3    3    0    3    2    0    0   32]
 [   0  863    0    0    0    0    6    1    4    0    0    0    1    1]
 [  13   16  831    2    1    0    2    0    0   37    9    1    0    3]
 [ 105    0    0 4985    0    3   10  339    2    4    9    0    7   39]
 [   4    4    3    0  689    1    0    0   21    0    1   20    0   11]
 [   5    0    0    2    0 1483    3    4    0    0    2    0   72   15]
 [ 398   10    1    7    2   11  992  157    0   53  142   21   39 2324]
 [   4    0    0   13    0    0    0 1129    0    0    3    0    2   11]
 [   0    0    0    5    0    0    0   19  814    0    1    0   10   18]
 [   2    0    1    0    0    0    0    0    0  912    5    0    0    9]
 [  44    0    0   24    0   19    0    2    0    9 5329    0    3   54]
 [   2    0    3    0  136   17    0    0    1    0    0  571    0   33]
 [   1    0    0    0    0    5    0    7    5    1   11    0 1524   30]
 [ 334    2    1   10    4   18 1474   36    2   43   36    8  210 1828]]
accuracy 0.7755527182313017
total 23082 29762

gm with gaussian
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1107    0    0    1    0    2   32    8    0    0    1    1    0   24]
 [   0  852    0    0    1    0   20    0    2    0    0    0    0    1]
 [   4    6  843    4    0    1   12    0    0   22   21    0    0    2]
 [  17    0    0 5154    0    0   39  231    2    7    8    0    3   42]
 [   1    2    0    0  654    0   49    0    3    0    0   28    0   17]
 [   4    0    0    0    0 1483   25    3    0    0   15    0   19   37]
 [ 244    8    8   18    3   13 2206  327    4   56  178   71   98  923]
 [   7    0    0   10    0    0    9 1132    1    0    0    0    0    3]
 [   1    3    0    7    0    0    7    5  829    0    0    0    1   14]
 [   2    0    1    0    2    1    0    1    0  905    4    1    3    9]
 [  30    0    0    7    0   20    9    2    0    7 5315    1    5   88]
 [   1    0    2    0  111   12  131    0    0    0    0  488    0   18]
 [   1    0    1    6    0   16   28    1    9    1    5    0 1494   22]
 [ 456    5    2    9    1   15 1934   98    0   25   93    7  229 1132]]
accuracy 0.7927558631812378
total 23594 29762

fullset gaussian 0.5 no dataaug
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2463     0     0     6     0     3     0     4     0     1     6     0 1     3]
 [    0  1730     0     0     1     0     0     0     1     0     0     0 1     0]
 [    1     0  2010     9     0     0     0     0     0     1     0     0 0     0]
 [    3     0     1 10868     0     2     0     0     0     1     0     0 0     0]
 [    0     1     2     0  1577     2     0     0     0     0     0     5 0     0]
 [    1     0     0     8     1  3085     0     2     0     0     0     0 75     0]
 [    0     0     0     0     0     0 20701     2     0     0     1     0 0    11]
 [    1     0     0     0     0     0     0  2407     1     1     0     0 4     0]
 [    0     0     0     0     0     0     0     2  1712     1     0     0 8     0]
 [    0     0     0     0     0     0     0     0     0  2024    10     1 1     0]
 [    0     0     0     0     0     0     0     2     0     2 10820     0 1     0]
 [    0     1     0     0    31     2     0     0     1     0     0  1558 0     0]
 [    0     0     0     0     0     0     0     1     8     0     0     1 3171     0]
 [    1     0     0     1     0     0     0     0     0     2     1     0 0 20243]]
accuracy 0.9971516369223496
total 84369 84610

model11 same as model10 but with blur 0 0.5 for train and none for test
testset
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 497    0    0    0    0    0    0    1    0    0    0    0    0    0]
 [   0  351    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  401    0    0    0    0    0    0    0    0    0    0    0]
 [   1    0    1 2212    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  322    0    0    0    0    0    0    1    0    0]
 [   0    0    0    0    0  632    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4106    0    0    0    0    0    0    2]
 [   0    0    0    0    0    0    0  458    2    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  335    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  415    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 2219    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  335    0    0]
 [   0    0    0    0    0    0    0    0    1    0    0    0  585    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4045]]
accuracy 0.9994681479730528
total 16913 16922

[0.99799197, 1.        , 1.        , 0.99909666, 0.99690402,
       1.        , 0.99951315, 0.99565217, 1.        , 1.        ,
       1.        , 1.        , 0.99829352, 1.        ]

gm testloader no gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1154    0    0    1    0    0    4    2    0    0    2    0    0   13]
 [   0  864    0    0    0    0   12    0    0    0    0    0    0    0]
 [   3    0  895    3    0    0    0    0    0   12    2    0    0    0]
 [  46    0    1 5197    0    1   56   59    5   17   18    0    2  101]
 [   0    0    0    0  688    0    1    0   14    2    2   42    0    5]
 [   2    0    0    1    0 1532    6    0    0    0    7    0   31    7]
 [ 482    5    4   16    1    3 2019  126    2   23   43    9   15 1409]
 [   2    1    0    6    0    0    1 1145    1    0    0    0    0    6]
 [   0    0    0    4    0    0    0    6  854    0    0    0    1    2]
 [   1    0    2    2    0    1    0    0    0  914    4    0    0    5]
 [  24    2    1    3    0   14    0    0    0    2 5369    0    2   67]
 [   0    2    1    0   42    8    3    0    0    0    0  701    0    6]
 [   1    0    0    4    0   11    1    1    8    1    8    0 1525   24]
 [ 527    2    2   16    2   14 1751   39    2   51   43   13  156 1388]]
accuracy 0.8146293931859419
total 24245 29762

[0.98129252, 0.98630137, 0.97814208, 0.94439397, 0.91246684,
       0.96595208, 0.48568679, 0.98537005, 0.98500577, 0.98385361,
       0.97902991, 0.91874181, 0.96275253, 0.34648028]

fulldataset shuffle with 0.5 gauss
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2484     0     0     1     0     1     0     0     0     0     0     1 0     0]
 [    0  1733     0     0     0     0     0     0     0     0     0     0 0     0]
 [    0     0  2018     3     0     0     0     0     0     0     0     0 0     0]
 [    1     0     0 10873     0     0     0     0     0     0     1     0 0     0]
 [    0     0     0     0  1581     2     0     0     0     0     0     4 0     0]
 [    0     0     0     0     0  3171     0     0     0     0     0     0 1     0]
 [    0     0     0     0     0     0 20712     0     0     0     0     0 0     3]
 [    0     0     0     0     0     0     0  2411     1     0     0     0 2     0]
 [    0     0     0     0     0     0     0     0  1721     0     0     1 1     0]
 [    0     0     0     0     0     0     0     0     0  2027     9     0 0     0]
 [    0     0     0     0     0     0     0     0     0     1 10824     0 0     0]
 [    0     0     0     0     2     1     0     0     0     0     0  1590 0     0]
 [    0     0     0     0     0     1     0     0     7     0     0     1 3172     0]
 [    1     0     0     0     0     0     0     0     0     0     0     0 0 20247]]
accuracy 0.9994563290391206
total 84564 84610

[0.99879373, 1.        , 0.99851559, 0.99981609, 0.99621928,
       0.99968474, 0.99985518, 0.99875725, 0.99883923, 0.99557957,
       0.99990762, 0.99811676, 0.9971707 , 0.99995061]

model12 same as before without any data aug
    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 494    0    0    0    0    0    0    1    0    0    0    0    0    0]
 [   0  333    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  400    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 2180    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  292    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  648    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4157    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  464    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  389    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  433    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 2171    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  296    0    0]
 [   0    0    0    0    0    0    0    0    2    0    0    0  609    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4053]]
accuracy 0.9998227159910176
total 16919 16922
[0.9979798 , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 0.99672668, 1.        ]

testloader 1n
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 575    0    0    1    0    0    3    1    0    0    0    0    0   10]
 [   0  416    0    0    0    0    0    0    1    0    0    0    0    2]
 [   0    0  535    2    0    0    1    0    0    2    1    0    0    0]
 [  13    0    0 2490    0    0    4    3    0    0   13    0    1   64]
 [   1    9    0    1  352    0    0    5   17    0    0    5    0    8]
 [   1    0    0    1    0  727    2    1    0    0    2    0    5   11]
 [  26   22   28   18    5   27 5777    9    1  220  387  190   45 1520]
 [   3    0    0    1    0    0    0  540    1    0    1    0    1   13]
 [   0    0    0    0    0    0    0    7  403    1    0    0    1    6]
 [   0    0    0    0    0    0    0    0    0  522    5    0    0    4]
 [  17    0    0    2    0    3    0    0    0    2 2525    0    1   46]
 [   0   19    0    0   50    0    0    0    3    0    0  316    0   11]
 [   0    0    0    2    1    1    0    2    0    0    3    0  735   11]
 [ 218    3    4    5    5   48 4494   41   19  111  102   19  191 2736]]
accuracy 0.6954430190930787
total 18649 26816

[0.97457627, 0.9928401 , 0.98890943, 0.96213292, 0.88442211,
       0.96933333, 0.69812689, 0.96428571, 0.96411483, 0.98305085,
       0.97265023, 0.79197995, 0.97350993, 0.34217109]

testloader 23
    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 718    0    0    0    0    0    0    3    0    0    0    0    0    0]
 [   0  438    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  565    0    0    0    0    0    0    0    0    0    0    0]
 [   1    0    0 2741    0    0    0   17    0    0   13    0    0   12]
 [   1    0    0    0  430    0    0    0    0    0    0    1    0    3]
 [   0    0    0    0    0  836    0    0    0    0    0    0    0    0]
 [ 175    0    0    0    0    0 2128    7    0    2    0    0    2 5969]
 [   1    0    0    0    0    0    0  691    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  434    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0  570    0    0    0    6]
 [   1    0    0    0    0    0    0    0    0    0 2734    0    0   10]
 [   0    0    0    0    0    0    0    0    0    0    0  431    0    0]
 [   0    0    0    0    0    1    0    0    0    0    0    0  841    0]
 [ 394    1    7    4   10   23 5444   16    0   11   15   35  175 2111]]
accuracy 0.5589326484018264
total 15668 28032

[0.99583911, 1.        , 1.        , 0.9845546 , 0.98850575,
       1.        , 0.25691175, 0.99855491, 0.99086758, 0.98958333,
       0.99599271, 1.        , 0.99881235, 0.25600291]

testloader gm
    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1152    0    0    0    0    0    3    3    0    0    1    0    0   17]
 [   0  864    0    0    0    0   10    0    2    0    0    0    0    0]
 [   1    1  899    1    0    0    1    0    0    7    3    0    0    2]
 [  46    0    0 5298    0    0   18   19    1    3   17    0    1  100]
 [   3    2    0    0  727    0    1    0    8    0    1    4    0    8]
 [   4    0    0    1    0 1553    1    0    0    0    3    0    7   17]
 [ 450    3    2   14    2    5 2154  132    1   17   53    9   13 1302]
 [  10    1    0    7    0    0    1 1132    0    0    2    0    1    8]
 [   2    1    0    4    0    0    0    6  843    0    1    1    2    7]
 [   3    0    2    0    0    0    0    0    0  911    3    0    0   10]
 [  33    1    1    5    0   14    0    0    0    6 5333    0    2   89]
 [   2    1    2    0   93    5    2    0    3    1    0  646    0    8]
 [   4    1    0    1    1    9    0    3    5    1    9    0 1524   26]
 [ 470    1    3   12    4   16 2044   32    1   32   39    7   64 1281]]
accuracy 0.8170485854445266
total 24317 29762

testloader everything
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2454     0     0     2     0     0     6     6     0     0     3     0     0    16]
 [    1  1721     0     0     0     0     7     1     0     0     0     0     0     3]
 [    1     0  1998     3     0     1     6     0     0     6     2     1     0     3]
 [   63     0     0 10487     0     1    17    49     0     5    44     0     2   207]
 [    5    14     0     0  1497     0     1     2    32     0     0    21     0    15]
 [    6     0     0     0     0  3112     6     1     0     0     8     0     9    30]
 [  661    24    29    31    14    29 10024   154     7   247   489   186    53  8767]
 [   17     0     0     6     0     0     2  2368     2     0     1     0     1    17]
 [    0     3     0     4     0     0     1    10  1681     0     1     0     3    20]
 [    2     0     3     2     0     0     1     0     0  2003     8     0     0    17]
 [   44     0     1     9     0    24     0     0     0     2 10619     1     1   124]
 [    3    16     0     1   144     6     7     0     2     1     1  1391     0    21]
 [    2     0     1     3     1    10     1     0     4     0    13     1  3106    39]
 [ 1077    15    10    21    29    73 11954    92    21   147   184    74   398  6153]]
accuracy 0.6927549934995864
total 58614 84610

[0.986731  , 0.99307559, 0.9886195 , 0.96432184, 0.94328922,
       0.98108449, 0.48390056, 0.98094449, 0.97562391, 0.98379175,
       0.98096998, 0.87319523, 0.97642251, 0.30388186]

fulldataset 0.5 gauss loader
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2486     0     0     1     0     0     0     0     0     0     0     0 0     0]
 [    0  1733     0     0     0     0     0     0     0     0     0     0 0     0]
 [    0     0  2019     2     0     0     0     0     0     0     0     0 0     0]
 [    2     0     0 10873     0     0     0     0     0     0     0     0 0     0]
 [    0     0     0     0  1585     0     0     0     0     0     0     2 0     0]
 [    0     0     1     0     0  3171     0     0     0     0     0     0 0     0]
 [    0     0     0     0     0     0 20715     0     0     0     0     0 0     0]
 [    0     0     0     0     0     0     0  2411     1     0     0     0 2     0]
 [    0     0     0     0     0     0     0     0  1722     0     0     0 1     0]
 [    0     0     0     0     0     0     0     0     0  2027     9     0 0     0]
 [    0     0     0     0     0     0     0     0     0     1 10824     0 0     0]
 [    0     0     0     0     2     1     0     0     0     0     0  1590 0     0]
 [    0     0     0     0     0     0     0     0     4     0     0     0 3177     0]
 [    0     0     0     0     0     0     0     0     0     0     0     0 0 20248]]
accuracy 0.9996572509159674
total 84581 84610

[0.99959791, 1.        , 0.99901039, 0.99981609, 0.99873976,
       0.99968474, 1.        , 0.99875725, 0.99941962, 0.99557957,
       0.99990762, 0.99811676, 0.99874253, 1.        ]

resnet50
x 26000
Wall time: 1h 10min 9s

10 iterations
3456041.298397064

1e3 iterations
Wall time: 8.11 s
3457103.5955085754

1e6 iterations
Wall time: 8 s
3453756.857749939

1n
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 117   11    9   51   23   44   78   40   23   27   48   87   31    1]
 [  88    6    2   29   23   37   48   25   24    8   37   80   10    2]
 [ 118   12    9   27   34   42   68   40   19   10   59   79   21    3]
 [ 518   54   44  226   88  211  310  168   98   86  237  376  159   13]
 [  74    8    4   29   19    6   44   24   23    8   58   82   18    1]
 [ 133    4   12   63   24   53  117   61   28   30   55  140   16   14]
 [ 628  811 1083  355  988    5 1028 1505  304  117  838  457  127   29]
 [ 112    6    9   41   22   45   46   50   27   19   48  106   24    5]
 [  82    9    2   52   51    6   37   21   33    7   62   50    4    2]
 [  94    5   10   39   28   22   43   77   11   11   52  114   19    6]
 [ 482   23   57  187  113  132  334  154  123   89  284  511   91   16]
 [  97    5    3   36   21    6   38   21   26   19   52   61   10    4]
 [ 100   17   14   40   28   53  136   45   27   21   60  170   17   27]
 [ 178  285   23 1026   45    0  482  218 1319 1081  485  386 1516  952]]
accuracy 0.10687649164677804
total 2866.0 26816.0

[0.19830508, 0.01431981, 0.01663586, 0.08732612, 0.04773869,
       0.07066667, 0.12422961, 0.08928571, 0.07894737, 0.02071563,
       0.10939908, 0.15288221, 0.02251656, 0.11905953]


1e6 but no normalization
Wall time: 11.7 s
x 26000
Wall time: 2min 48s
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[  25   42   18    7  135   50   47   65   74   34   34    7    4   48]
 [  10   44    5    1   92   39   54   38   81    3   22    1    2   27]
 [  21   40   17    3  146   51   72   45   66   11   28    7    7   27]
 [ 108   94   77   65  546  217  266  346  398   60  182   56   23  150]
 [  32   39    7    8   96   32   67   31   45   12    0    2    5   22]
 [  23   30   15    9  165   95  101   97   60   33   52    8    0   62]
 [1072  161 1358   95  862  710 1145 1357  904  193    1   27    6  384]
 [  27   53   14    5  154   51   68   34   69   24   18    5    4   34]
 [  17   96   16    2   79   35   60   20   58   19    0    1    0   15]
 [  31   50   20    1  120   66   68   46   54   17    9    3    3   43]
 [ 151  139   79   37  602  267  364  247  319  109  117   15   14  136]
 [  29   74    6    5  105   13   28   29   62   13    2    3    3   27]
 [  30   34   23   15  183   86  126   82   53   33   41    2    1   46]
 [  77    3   12 1332  258  533  791  488  204  946    0 1216  966 1170]]
accuracy 0.1076596062052506
total 2887.0 26816.0
[0.04237288, 0.10501193, 0.03142329, 0.02511592, 0.24120603,
       0.12666667, 0.13836858, 0.06071429, 0.13875598, 0.03201507,
       0.04506934, 0.0075188 , 0.0013245 , 0.14632316]

cnn13 model13 same as model12 except no batchnorm
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 16, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(5, 5), stride=(1, 1))
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=5408, out_features=120, bias=True)
  (drop2): Dropout(p=0.3, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

trainloader 1n gm 23 0.8 0.5 gauss shuffle true
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2001     0     0    13     0     5     0     0     0     3     0     2 0     0]
 [    0  1366     0     1     0     0     0     0     1     0     0     0 0     0]
 [    1     1  1608     4     4     1     0     0     0     0     0     0 0     0]
 [    1     0     2  8664     0     1     0     1     0     1     0     3 0     0]
 [    0     0     0     0  1202     2     0     0     3     0     0    56 0     0]
 [    7     0     0     3     0  2532     0     1     0     1     3     3 5     0]
 [    0     0     0     0     0     0 16617     0     0     0     2     0 0    13]
 [    5     0     0     2     0     0     1  1911     8     1     4     3 8     0]
 [    0     1     0     0     1     0     0     1  1357     1     0     1 7     0]
 [    0     0     0     0     0     0     0     0     1  1557    25     1 0     0]
 [    0     0     0     0     0     0     3     0     0    12  8642     0 0    13]
 [    0     0     0     0    72     1     0     0     0     0     1  1226 0     0]
 [    0     0     0     0     0     2     0     1    10     5     3     3 2489     0]
 [    0     0     0     0     0     0     1     0     0     1     3     0 0 16170]]
accuracy 0.9948883110743411
total 67342 67688

testloader 0.2 shuffle false
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 536    0    0    5    0    0    0    0    0    0    0    0    0    0]
 [   1  336    0    0    0    0    0    0    1    0    0    0    0    0]
 [   0    0  384    3    1    0    0    0    0    0    0    0    0    0]
 [   1    0    0 2152    0    0    0    1    0    0    0    0    0    0]
 [   0    0    0    1  317    2    0    0    0    0    0   15    0    0]
 [   1    0    0    1    0  648    0    0    0    0    0    0    2    0]
 [   0    0    0    0    0    0 4090    0    0    0    0    0    0    3]
 [   1    0    0    1    0    0    2  495    2    0    0    1    0    0]
 [   0    0    0    0    0    0    0    0  315    1    0    0    4    0]
 [   0    0    0    0    0    0    1    0    1  393    4    0    1    0]
 [   0    0    0    0    0    0    1    0    0    4 2197    0    0    1]
 [   0    0    0    0   19    1    0    0    0    0    0  287    0    0]
 [   0    0    0    0    0    0    0    0    0    3    1    3  608    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4074]]
accuracy 0.9946814797305283
total 16832 16922

[0.99075786, 0.99408284, 0.98969072, 0.99907149, 0.94626866,
       0.99386503, 0.99926704, 0.98605578, 0.984375  , 0.9825    ,
       0.99727644, 0.93485342, 0.98861789, 1.        ]


testloader 0.2 shuffle true
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 482    1    0    2    0    1    0    0    0    0    0    0    0    0]
 [   0  346    0    1    0    0    0    0    0    0    0    0    0    0]
 [   0    0  356    2    0    0    0    0    0    0    0    1    0    0]
 [   1    0    0 2181    0    0    0    0    0    1    0    0    0    0]
 [   0    0    0    0  325    0    0    0    1    0    0   14    0    0]
 [   1    0    0    0    0  634    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4134    0    0    0    1    0    0    3]
 [   3    0    0    0    0    0    1  499    1    1    1    1    1    0]
 [   0    0    0    0    1    0    0    1  349    1    0    1    4    0]
 [   0    0    0    0    0    0    0    0    0  420    1    0    0    0]
 [   0    0    0    0    0    0    0    0    0    1 2112    0    0    2]
 [   0    1    0    0   17    0    0    0    0    0    0  285    0    0]
 [   0    0    0    0    0    0    1    0    3    0    0    1  590    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4135]]
accuracy 0.995626994445101
total 16848 16922

[0.99176955, 0.99711816, 0.99164345, 0.99908383, 0.95588235,
       0.9984252 , 0.99903335, 0.98228346, 0.97759104, 0.9976247 ,
       0.99858156, 0.94059406, 0.99159664, 1.        ]

again
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 479    0    0    3    0    2    0    1    0    0    1    0    0    0]
 [   0  345    1    0    1    0    0    0    0    0    0    0    0    0]
 [   0    0  356    2    0    0    0    0    0    0    0    1    0    0]
 [   1    0    0 2180    0    0    0    1    0    1    0    0    0    0]
 [   0    0    0    1  326    0    0    0    0    0    0   13    0    0]
 [   3    0    0    1    0  628    0    0    0    0    0    1    2    0]
 [   0    0    0    0    0    0 4134    1    0    0    0    0    0    3]
 [   3    0    0    2    0    0    1  497    0    1    0    2    2    0]
 [   0    0    0    2    0    0    0    0  351    0    0    0    4    0]
 [   0    0    0    0    0    0    0    0    0  419    2    0    0    0]
 [   0    0    0    0    0    0    0    0    0    1 2112    0    0    2]
 [   0    0    0    0   18    0    0    0    0    0    0  285    0    0]
 [   0    0    0    0    0    0    0    0    1    1    0    1  592    0]
 [   0    0    0    0    0    0    0    0    0    0    1    0    0 4134]]
accuracy 0.9950360477484931
total 16838 16922

pil gm
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1161    0    0    5    0    0    0    1    1    1    1    1    5    0]
 [   0  876    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  906    3    4    0    0    0    0    0    0    2    0    0]
 [   1    0    0 5490    1    2    0    3    1    2    1    2    0    0]
 [   0    0    1    0  720    2    0    0    0    0    0   31    0    0]
 [   4    0    0    3    1 1568    0    0    2    0    0    3    5    0]
 [   0    0    0    0    0    0 4142    2    0    0    1    0    0   12]
 [   4    0    0    0    0    0    2 1139    7    0    2    0    8    0]
 [   0    0    0    0    0    0    0    2  853    1    0    0   11    0]
 [   0    0    0    0    0    0    1    0    1  914   11    0    2    0]
 [   0    0    0    0    0    0    2    0    0   20 5458    0    0    4]
 [   0    0    0    0   30    0    0    0    0    0    1  732    0    0]
 [   0    0    0    0    0    1    0    0   12    3    3    2 1563    0]
 [   0    0    0    0    0    0    2    0    0    3   10    0    0 3991]]
accuracy 0.9916336267723943
total 29513 29762
[0.9872449 , 1.        , 0.99016393, 0.99763765, 0.95490716,
       0.98865069, 0.99639163, 0.98020654, 0.98385236, 0.98385361,
       0.99525894, 0.9593709 , 0.98674242, 0.99625562]


cbnn1
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=2704, out_features=120, bias=True)
  (drop2): Dropout(p=0.3, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

7799 [10,   779] loss: 0.036
    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 494    0    0    7    0    8    0    1    0    0    0    1    0    0]
 [   0  357    1    1    2    0    0    0    1    0    0    7    1    0]
 [   0    0  453    3    0    2    0    0    0    0    0    0    1    0]
 [   5    0    1 2398    0    1    0    0    0    1    1    5    1    0]
 [   2    5    1    1  341    4    0    0    0    0    0   16    0    0]
 [   1    0    0    2    1  655    0    0    0    0    0    0    0    0]
 [   0    3    0    1    2    3 4944    1    3    0    4    3    2    6]
 [   3    1    0    1    0    0    4  523    2    0    2    2    2    0]
 [   0    5    0    0    1    0    1    3  332    1    0    1    4    0]
 [   0    1    0    1    0    0    0    0    1  427   10    0    4    0]
 [   0    0    0    1    0    0   10    3    0    6 2363    2   12    1]
 [   1    1    0    0   21    4    2    0    0    0    0  314    3    0]
 [   0    0    0    0    1    2    0    5    3    0    3    0  693    0]
 [   0    0    0    1    0    0    5    0    0    0    1    0    0 4939]]
accuracy 0.9871683005697275
total 19233 19483

[0.9667319 , 0.96486486, 0.9869281 , 0.99378367, 0.92162162,
       0.9939302 , 0.99436846, 0.96851852, 0.95402299, 0.96171171,
       0.9854045 , 0.90751445, 0.98019802, 0.99858471]

cbnn1b without dropout
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=2704, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)
7799 [10,   779] loss: 0.014
..\data\out\model_exp_cbnn1b_7800.pth
Finished Training
Wall time: 32min 5s
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 498    0    0    9    0    3    0    0    0    0    0    1    0    0]
 [   0  364    0    0    0    0    0    0    2    0    0    4    0    0]
 [   0    0  457    0    0    1    0    1    0    0    0    0    0    0]
 [   1    1    0 2407    0    2    0    0    0    0    0    1    1    0]
 [   0    4    0    1  357    1    0    0    0    0    0    7    0    0]
 [   0    0    0    0    0  658    0    0    0    0    0    1    0    0]
 [   0    1    0    1    0    0 4968    0    0    0    0    1    0    1]
 [   0    0    0    4    0    0    0  528    2    1    2    3    0    0]
 [   0    0    0    0    0    0    0    4  341    2    0    0    1    0]
 [   0    0    0    0    0    0    0    0    1  432    7    2    2    0]
 [   0    0    0    0    0    0    2    0    1    1 2391    3    0    0]
 [   0    0    0    0    2    1    0    1    0    0    0  341    1    0]
 [   0    0    0    0    0    1    0    5    7    0    5    6  683    0]
 [   0    0    0    0    0    0    1    0    0    0    1    0    0 4944]]
accuracy 0.9941487450597957
total 19369 19483

[0.97455969, 0.98378378, 0.9956427 , 0.99751347, 0.96486486,
       0.99848255, 0.99919549, 0.97777778, 0.97988506, 0.97297297,
       0.9970809 , 0.98554913, 0.96605375, 0.99959563]

0.8     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2119     2     1    26     0     8     0     0     0     0     0     1 0     0]
 [    0  1533     0     1     1     0     0     0     1     0     0     4 0     0]
 [    1     0  1762     7     0     0     0     0     0     0     0     0 0     0]
 [    1     2     1  9485     0     2     0     0     0     0     2     4 0     0]
 [    0     2     0     2  1322     1     0     1     0     0     0    14 0     0]
 [    0     0     0    14     4  2763     0     0     0     0     0     1 0     0]
 [    0     1     0     2     1     0 20118     1     0     0     5     3 0     3]
 [    0     0     0     4     0     0     0  2042    10     1     2     8 3     0]
 [    1     1     0     0     0     0     0     5  1535     4     0     1 5     0]
 [    0     0     0     0     0     0     0     2     2  1772    16     1 2     0]
 [    0     0     0     0     0     0     4     0     0     7  9431    12 2     5]
 [    0     0     0     1     8     1     0     0     1     0     2  1365 2     0]
 [    0     0     0     2     2     1     0    12    22     9    37    11 2649     0]
 [    0     0     0     1     0     0     1     0     0     0     1     0 0 19702]]
accuracy 0.9957397664570768
total 77598 77930
[0.98238294, 0.99545455, 0.99548023, 0.99873644, 0.98509687,
       0.99317038, 0.99920532, 0.98647343, 0.98904639, 0.98718663,
       0.99682909, 0.98913043, 0.96502732, 0.99984775]

cbnn2
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 12, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(12, 24, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=4056, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)
7799 [10,   779] loss: 0.018
..\data\out\model_exp_cbnn2_7800.pth
Finished Training
Wall time: 33min 29s
  0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2145     3     0     6     0     1     0     0     0     0     0     1 1     0]
 [    1  1535     0     0     1     0     1     1     0     0     0     1 0     0]
 [    2     1  1764     3     0     0     0     0     0     0     0     0 0     0]
 [    6     5     1  9463     0     3     1     2     0     1    11     1 2     1]
 [    1    13     5     1  1301     0     0     3     0     0     1    17 0     0]
 [   16     0     2     4     2  2750     2     1     0     0     3     0 2     0]
 [    0     1     0     0     0     1 20124     1     0     0     4     0 0     3]
 [    3     0     0     1     0     0     2  2048     1     1     6     3 5     0]
 [    0     2     0     0     0     0     0    14  1502     8     8     0 18     0]
 [    0     0     0     0     0     0     0     0     0  1750    39     0 6     0]
 [    0     0     0     0     0     0     4     0     0     1  9446     1 2     7]
 [    0     0     0     1     1     0     1     0     0     0    26  1341 10     0]
 [    1     0     0     1     0     0     3     4     1     4    46     0 2684     1]
 [    0     0     0     0     0     0     0     0     0     1    13     0 0 19691]]
accuracy 0.9950468369049147
total 77544 77930

[0.99443672, 0.99675325, 0.99661017, 0.99641992, 0.96944858,
       0.98849748, 0.99950333, 0.98937198, 0.96778351, 0.97493036,
       0.99841454, 0.97173913, 0.97777778, 0.99928952]


     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 507    0    0    2    0    1    0    0    0    0    0    1    0    0]
 [   0  364    0    0    0    0    0    0    2    0    0    4    0    0]
 [   0    0  458    0    0    0    0    1    0    0    0    0    0    0]
 [   4    1    1 2397    0    2    2    2    0    0    3    0    1    0]
 [   0    6    0    1  351    0    0    0    0    0    0   12    0    0]
 [   1    1    0    1    0  656    0    0    0    0    0    0    0    0]
 [   0    1    0    1    0    0 4968    0    0    0    0    0    0    2]
 [   0    0    0    0    0    0    2  534    1    1    2    0    0    0]
 [   0    0    0    0    0    0    1    5  331    1    5    0    5    0]
 [   0    0    0    0    0    0    0    0    1  425   15    1    2    0]
 [   0    0    0    0    0    0    2    0    0    0 2395    0    1    0]
 [   0    0    0    1    1    2    0    0    0    0    6  334    2    0]
 [   0    0    0    1    0    0    0    1    2    1    4    0  697    1]
 [   0    0    0    0    0    0    0    0    0    0    3    0    0 4943]]
accuracy 0.993686803880306
total 19360 19483

0.99217221, 0.98378378, 0.99782135, 0.99336925, 0.94864865,
       0.99544765, 0.99919549, 0.98888889, 0.95114943, 0.95720721,
       0.99874896, 0.96531792, 0.98585573, 0.99939345]

cbnn3
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 16, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=5408, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

7799 [10,   779] loss: 0.022
..\data\out\model_exp_cbnn3_7800.pth
Finished Training
Wall time: 52min 47s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 500    0    0    7    0    3    0    0    0    0    0    1    0    0]
 [   1  361    0    0    1    0    0    0    2    0    0    5    0    0]
 [   0    0  458    0    0    0    0    1    0    0    0    0    0    0]
 [   1    0    1 2402    2    4    0    0    0    0    0    2    1    0]
 [   0    2    0    0  361    0    0    0    0    0    0    7    0    0]
 [   0    0    0    2    1  655    1    0    0    0    0    0    0    0]
 [   1    0    0    0    0    0 4970    0    0    0    0    0    0    1]
 [   0    0    0    3    0    0    4  531    1    0    1    0    0    0]
 [   0    0    0    0    0    0    2    3  338    4    0    0    1    0]
 [   0    0    0    0    0    0    0    0    1  433    6    2    2    0]
 [   0    0    0    0    0    0   23    0    2    2 2369    0    1    1]
 [   0    0    0    0    8    2    5    0    0    1    2  327    1    0]
 [   0    0    0    2    0    0    1    6    4    2    0    1  691    0]
 [   0    0    0    0    0    0    0    0    0    0    4    0    0 4942]]
accuracy 0.9925576143304419
total 19338 19483

[0.97847358, 0.97567568, 0.99782135, 0.99544136, 0.97567568,
       0.9939302 , 0.99959775, 0.98333333, 0.97126437, 0.97522523,
       0.98790659, 0.94508671, 0.97736917, 0.99919127]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2104     0     3    40     0     8     1     0     0     0     0     1 0     0]
 [    6  1517     1     0     8     0     2     0     3     0     0     3 0     0]
 [    0     0  1763     5     1     0     0     0     0     0     0     0 1     0]
 [    4     2     4  9478     0     4     2     0     0     1     1     1 0     0]
 [    0     0     1     1  1321     0     1     2     0     0     0    16 0     0]
 [    0     0     1    12     6  2757     3     1     0     0     0     0 2     0]
 [    0     0     0     0     1     0 20129     1     0     0     1     0 0     2]
 [    2     0     0     3     0     0     6  2046     6     1     1     3 2     0]
 [    0     1     0     0     0     0     2     7  1528     5     2     0 7     0]
 [    0     0     0     0     0     0     3     3     1  1773    12     0 3     0]
 [    0     0     0     0     0     1    60     0     3     8  9373     3 5     8]
 [    0     0     0     1    20     0     7     3     1     9     8  1327 4     0]
 [    0     0     0     3     2     0     6    14     5    21    18     6 2666     4]
 [    0     0     0     2     0     0     0     0     0     1     9     0 0 19693]]
accuracy 0.9941614269215963
total 77475 77930

[0.97542884, 0.98506494, 0.9960452 , 0.99799937, 0.98435171,
       0.99101366, 0.99975166, 0.9884058 , 0.98453608, 0.98774373,
       0.99069866, 0.9615942 , 0.9712204 , 0.99939102]


cbnn3 dropout 0.5 0.4
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 16, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(5, 5), stride=(1, 1))
  (drop1): Dropout(p=0.5, inplace=False)
  (fc1): Linear(in_features=5408, out_features=120, bias=True)
  (drop2): Dropout(p=0.4, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

7799 [10,   779] loss: 0.028
..\data\out\model_exp_cbnn3_d0.5_0.4_7800.pth
Finished Training
Wall time: 1h 9min 29s

Wall time: 5min 52s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2118     1     2    31     0     4     0     0     0     0     0     0
      1     0]
 [    1  1528     0     1     2     0     0     0     4     0     0     4
      0     0]
 [    0     0  1762     8     0     0     0     0     0     0     0     0
      0     0]
 [    1     1     2  9488     0     2     0     0     0     0     2     1
      0     0]
 [    1     2     3     2  1314     3     0     3     0     0     0    14
      0     0]
 [    3     0     3    14     4  2752     0     0     2     0     0     0
      4     0]
 [    0     0     0     0     1     1 20086     1     1     0    20     0
     14    10]
 [    0     0     0     2     0     0     0  2030    10     2     4     7
     15     0]
 [    0     1     0     0     0     0     0     2  1525     2     6     0
     16     0]
 [    0     0     0     0     0     0     0     0     0  1754    27     0
     14     0]
 [    0     0     0     0     0     1     1     0     0     7  9429     4
     14     5]
 [    0     1     0     2    24     1     1     0     3     2    20  1312
     14     0]
 [    0     0     0     0     0     0     0     1     7     1    17     1
   2716     2]
 [    0     0     0     2     0     0     0     0     0     0     8     0
      1 19694]]
accuracy 0.9945848838701399
total 77508 77930

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 496    0    0   13    0    1    0    0    0    0    0    1    0    0]
 [   0  364    0    0    0    0    0    0    2    0    0    4    0    0]
 [   0    0  458    0    0    0    0    1    0    0    0    0    0    0]
 [   1    1    0 2408    0    2    0    0    0    0    0    0    1    0]
 [   0    4    0    1  357    1    0    0    0    0    0    7    0    0]
 [   0    0    0    0    1  658    0    0    0    0    0    0    0    0]
 [   0    1    0    1    1    0 4958    1    0    0    3    0    3    4]
 [   0    0    0    4    0    0    1  525    3    1    2    0    4    0]
 [   0    1    0    1    0    0    0    0  339    2    1    0    4    0]
 [   0    0    0    0    0    0    0    0    1  427   11    2    3    0]
 [   0    0    0    0    0    0    2    0    0    2 2390    0    3    1]
 [   0    2    0    0    8    2    0    0    0    0    4  328    2    0]
 [   0    0    0    1    0    0    0    0    5    0    0    0  701    0]
 [   0    0    0    0    0    0    0    0    0    0    2    0    1 4943]]
accuracy 0.9932761894985371
total 19352 19483

cbnn3 0.4 0.3
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 16, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(5, 5), stride=(1, 1))
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=5408, out_features=120, bias=True)
  (drop2): Dropout(p=0.3, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

..\data\out\model_exp_cbnn3_d0.4_0.3_7800.pth
Finished Training
Wall time: 1h 25min 2s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 504    0    0    3    0    3    0    0    0    0    0    1    0    0]
 [   0  364    0    0    0    0    0    0    2    0    0    4    0    0]
 [   0    0  458    0    0    0    0    1    0    0    0    0    0    0]
 [   2    1    2 2398    0    6    0    0    0    0    1    0    3    0]
 [   0   13    3    0  346    0    0    0    0    0    0    8    0    0]
 [   0    0    0    0    1  657    0    1    0    0    0    0    0    0]
 [   0    3    0    1    2    0 4960    0    1    0    3    0    0    2]
 [   0    0    0    0    0    0    3  526    6    0    2    0    3    0]
 [   0    0    0    0    0    0    2    0  343    1    0    0    1    1]
 [   0    0    0    0    0    0    1    0    3  428    9    1    2    0]
 [   0    0    0    0    0    0   10    0    0    1 2372    0    8    7]
 [   0    4    0    0    7    1    6    0    8    0    2  314    4    0]
 [   0    0    0    0    0    1    1    0    8    0    0    0  697    0]
 [   0    0    0    0    0    0    0    0    0    0    4    0    0 4942]]
accuracy 0.9910691371965303
total 19309 19483

[0.98630137, 0.98378378, 0.99782135, 0.99378367, 0.93513514,
       0.9969651 , 0.99758648, 0.97407407, 0.98563218, 0.96396396,
       0.98915763, 0.90751445, 0.98585573, 0.99919127]


    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2139     2     1     8     1     3     0     0     1     0     1     0 1     0]
 [    0  1534     0     0     1     0     0     0     3     0     0     2 0     0]
 [    1     2  1762     3     0     0     0     0     0     0     2     0 0     0]
 [   12     5     4  9457     0     5     1     0     1     0     1     0 5     6]
 [    3    39     2     1  1279     1     0     0     1     0     1    15 0     0]
 [    9     1     1     7     3  2746     1     1     5     0     1     1 6     0]
 [    0     4     0     0     1     1 20107     1     7     0     6     0 3     4]
 [    0     0     0     1     1     0     2  2019    31     1     1     2 12     0]
 [    0     1     0     0     0     0     0     1  1537     1     0     0 12     0]
 [    0     0     0     0     0     0     3     0     8  1761    13     0 10     0]
 [    1     0     0     0     0     0    30     0     2     9  9361     0 36    22]
 [    0    24     0     0    17     0    13     0    29     4    12  1263 18     0]
 [    0     0     0     1     0     0     2     1    23     4    17     0 2689     8]
 [    0     0     0     0     0     0     0     0     0     0     5     0 0 19700]]
accuracy 0.9926087514436033
total 77354 77930

[0.99165508, 0.9961039 , 0.99548023, 0.99578814, 0.95305514,
       0.98705967, 0.99865898, 0.97536232, 0.99033505, 0.9810585 ,
       0.98943029, 0.91521739, 0.97959927, 0.99974626]

cbnn3 0.4 0.5
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 16, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(5, 5), stride=(1, 1))
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=5408, out_features=120, bias=True)
  (drop2): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

7799 [10,   779] loss: 0.024
..\data\out\model_exp_cbnn3_d0.4_0.5_7800.pth
Finished Training
Wall time: 37min 44s

Wall time: 2min 10s
    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2123     0     2    16     0    14     0     0     0     1     0     1
      0     0]
 [    0  1530     0     0     2     0     0     0     3     0     0     5
      0     0]
 [    0     0  1764     4     1     1     0     0     0     0     0     0
      0     0]
 [    6     1     4  9479     0     4     0     1     0     0     1     1
      0     0]
 [    1     4     3     3  1314     1     0     1     0     0     0    15
      0     0]
 [    0     0     1     4     3  2772     0     1     0     0     1     0
      0     0]
 [    0     2     0     1     1     1 20094     4     0     0    18     0
      2    11]
 [    2     0     2     4     3     0     1  2039     6     2     3     3
      5     0]
 [    0     2     0     0     0     0     0     2  1529     4     4     0
     11     0]
 [    0     0     0     0     0     0     1     0     2  1753    34     0
      4     1]
 [    0     0     0     0     0     1     3     0     0     7  9434     0
      2    14]
 [    0     1     0     1    31     0     1     0     3     0    17  1314
     11     1]
 [    0     0     0     4     3     0     0     3     7    13    41     0
   2670     4]
 [    0     0     0     1     0     0     0     0     0     0     3     0
      0 19701]]
accuracy 0.9946875401000899
total 77516 77930

[0.98423737, 0.99350649, 0.99661017, 0.99810466, 0.97913562,
       0.99640546, 0.99801331, 0.98502415, 0.98518041, 0.97660167,
       0.99714618, 0.95217391, 0.9726776 , 0.99979701]

cbnn3 0.4 0.5
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 498    0    1    5    0    6    0    0    0    0    0    1    0    0]
 [   0  364    0    0    0    0    0    0    2    0    0    4    0    0]
 [   0    0  457    0    0    1    0    1    0    0    0    0    0    0]
 [   2    1    1 2402    0    5    0    0    0    0    1    0    1    0]
 [   0    4    0    1  359    2    0    0    0    0    0    4    0    0]
 [   0    0    0    0    1  658    0    0    0    0    0    0    0    0]
 [   0    0    0    1    3    0 4960    1    0    0    1    0    1    5]
 [   0    0    0    3    0    0    1  531    2    1    2    0    0    0]
 [   0    0    0    0    0    0    0    3  340    1    1    0    3    0]
 [   0    0    0    0    0    0    0    0    1  425   14    2    2    0]
 [   0    0    0    0    0    0    1    0    1    0 2394    0    0    2]
 [   0    0    0    0   11    2    0    0    0    0    4  327    2    0]
 [   0    0    0    1    0    0    1    0    5    1    2    0  696    1]
 [   0    0    0    0    0    0    0    0    0    0    1    0    0 4945]]
accuracy 0.9934814966894215
total 19356 19483

[0.97455969, 0.98378378, 0.9956427 , 0.99544136, 0.97027027,
       0.99848255, 0.99758648, 0.98333333, 0.97701149, 0.95720721,
       0.99833194, 0.94508671, 0.9844413 , 0.99979782]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2123     0     2    16     0    14     0     0     0     1     0     1 0     0]
 [    0  1528     0     0     3     0     0     0     3     0     0     6 0     0]
 [    0     0  1764     4     1     1     0     0     0     0     0     0 0     0]
 [    6     2     4  9478     0     4     0     1     0     0     1     1 0     0]
 [    1     4     2     3  1314     1     0     3     0     0     0    14 0     0]
 [    0     0     1     4     3  2772     0     1     0     0     1     0 0     0]
 [    0     2     0     1     1     1 20088     6     0     0    19     0 2    14]
 [    2     0     2     4     3     0     0  2039     6     2     3     3 6     0]
 [    0     1     0     0     0     0     0     3  1529     4     4     0 11     0]
 [    0     0     0     0     0     0     1     0     2  1753    34     0 4     1]
 [    0     0     0     0     0     1     2     0     0     7  9433     1 2    15]
 [    0     1     0     1    31     0     1     0     3     0    17  1314 12     0]
 [    0     0     0     3     3     0     0     3     7    11    42     0 2672     4]
 [    0     0     0     1     0     0     0     0     0     0     4     0 0 19700]]
accuracy 0.9945720518413961
total 77507 77930

cbnn1 0.5 0.4
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (drop1): Dropout(p=0.5, inplace=False)
  (fc1): Linear(in_features=2704, out_features=120, bias=True)
  (drop2): Dropout(p=0.4, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

7799 [10,   779] loss: 0.024
..\data\out\model_exp_cbnn1_d0.5_0.4_7800.pth
Finished Training
Wall time: 1h 4min 8s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2142     1     3     8     0     1     0     0     0     0     0     1 1     0]
 [    4  1525     0     0     1     0     0     0     2     0     0     7 1     0]
 [    2     1  1762     3     0     0     0     0     0     0     0     2 0     0]
 [    6     1     2  9474     0     4     0     0     0     2     4     4 0     0]
 [    1     0     1     0  1292     0     0     2     0     0     0    46 0     0]
 [    2     0     1     4     3  2768     0     0     0     0     0     2 2     0]
 [    0     1     0     0     0     1 20116     1     0     0     3     0 0    12]
 [    4     0     0     2     0     0     2  2031     6     2     4     6 13     0]
 [    1     0     0     0     0     0     0     1  1528     4     2     0 16     0]
 [    0     0     0     0     0     0     0     0     0  1762    26     0 6     1]
 [    0     0     0     0     0     1     6     0     0     4  9423     4 6    17]
 [    0     0     0     0     2     0     0     0     1     0     8  1357 12     0]
 [    0     0     0     0     0     0     0     1     5     2    24     3 2705     5]
 [    0     0     0     0     0     0     0     0     0     0     1     0 0 19704]]
accuracy 0.9956242781983832
total 77589 77930

[0.9930459 , 0.99025974, 0.99548023, 0.99757818, 0.96274218,
       0.99496765, 0.99910599, 0.98115942, 0.98453608, 0.9816156 ,
       0.99598351, 0.98333333, 0.98542805, 0.99994925]

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 507    0    0    3    0    0    0    0    0    0    0    1    0    0]
 [   0  363    1    0    0    0    0    0    1    0    0    4    1    0]
 [   0    0  458    0    0    0    0    1    0    0    0    0    0    0]
 [   4    0    0 2401    0    4    0    0    0    0    1    2    1    0]
 [   1    2    0    0  350    0    0    0    0    0    0   17    0    0]
 [   1    0    0    0    1  657    0    0    0    0    0    0    0    0]
 [   0    0    0    1    0    0 4967    0    0    0    0    0    0    4]
 [   0    0    0    1    0    0    0  529    3    1    2    3    1    0]
 [   0    0    0    0    0    0    0    1  338    1    0    0    8    0]
 [   0    0    0    0    0    0    0    0    1  426   11    2    4    0]
 [   0    0    0    0    0    0    1    0    1    0 2391    0    2    3]
 [   0    0    0    1    1    1    0    0    0    0    1  339    3    0]
 [   0    0    0    0    0    1    0    0    3    0    0    2  700    1]
 [   0    0    0    0    0    0    0    0    0    0    1    0    0 4945]]
accuracy 0.9942513986552379
total 19371 19483

[0.99217221, 0.98108108, 0.99782135, 0.99502694, 0.94594595,
       0.9969651 , 0.99899437, 0.97962963, 0.97126437, 0.95945946,
       0.9970809 , 0.97976879, 0.99009901, 0.99979782]

cbnn1 0.4 0.3
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=2704, out_features=120, bias=True)
  (drop2): Dropout(p=0.3, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)
7799 [10,   779] loss: 0.018
..\data\out\model_exp_cbnn1_d0.4_0.3_7800.pth
Finished Training
Wall time: 1h 33s
    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2144     0     3     3     3     2     0     0     0     0     0     1 1     0]
 [    1  1527     0     0     1     0     2     0     3     0     0     6 0     0]
 [    1     1  1762     3     0     1     0     1     0     0     0     1 0     0]
 [    6     3     4  9463     0     6     0     6     0     0     0     6 3     0]
 [    0     4     2     0  1304     2     1     2     0     0     0    27 0     0]
 [    3     0     2     2     4  2768     0     0     0     0     0     2 1     0]
 [    0     0     0     0     1     1 20126     2     0     0     2     0 0     2]
 [    0     0     0     1     0     0     0  2055     5     1     1     5 2     0]
 [    0     0     0     0     0     0     0    10  1530     3     0     0 9     0]
 [    0     0     0     0     0     0     1     3     4  1762    19     0 6     0]
 [    1     0     0     0     0     0    39     0     1     4  9389     4 20     3]
 [    0     0     0     1     5     0     3     0     0     0     5  1363 3     0]
 [    0     0     0     0     0     0     2     1     8     2    14     7 2711     0]
 [    0     0     0     0     0     0     5     2     0     0    14     0 2 19682]]
accuracy 0.995585782112152
total 77586 77930

[0.99397311, 0.99155844, 0.99548023, 0.99641992, 0.97168405,
       0.99496765, 0.99960266, 0.99275362, 0.98582474, 0.9816156 ,
       0.99238981, 0.98768116, 0.98761384, 0.99883278]

    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 504    0    0    5    0    0    1    0    0    0    0    1    0    0]
 [   0  364    0    0    0    0    0    0    2    0    0    4    0    0]
 [   0    0  458    0    0    0    0    1    0    0    0    0    0    0]
 [   1    0    1 2399    1    5    0    1    0    1    0    3    1    0]
 [   0    2    0    1  357    0    0    0    0    0    0   10    0    0]
 [   0    0    0    0    1  658    0    0    0    0    0    0    0    0]
 [   0    0    1    0    1    0 4969    0    0    0    0    0    0    1]
 [   0    0    0    0    0    0    2  534    2    0    2    0    0    0]
 [   0    0    0    0    0    0    1    5  339    2    0    0    1    0]
 [   0    0    0    0    0    0    0    0    1  429    9    2    3    0]
 [   0    0    0    0    0    0   15    0    0    0 2380    0    3    0]
 [   0    0    0    0    2    2    1    1    0    0    1  338    1    0]
 [   0    0    0    0    0    1    0    0    6    0    0    3  697    0]
 [   0    0    0    0    0    0    1    0    1    0    5    0    0 4939]]
accuracy 0.9939434378689114
total 19365 19483

cbnn1 0.4 0.5
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (drop1): Dropout(p=0.4, inplace=False)
  (fc1): Linear(in_features=2704, out_features=120, bias=True)
  (drop2): Dropout(p=0.5, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

7799 [10,   779] loss: 0.023
..\data\out\model_exp_cbnn1_d0.4_0.5_7800.pth
Finished Training
Wall time: 30min 42s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2127     2     0    15     2     9     0     0     1     0     0     1 0     0]
 [    0  1532     0     0     1     0     0     0     3     0     0     4 0     0]
 [    0     1  1763     3     1     1     0     0     0     0     0     1 0     0]
 [    3     2     0  9481     0     4     0     0     0     2     3     2 0     0]
 [    0     6     0     0  1319     0     0     3     0     0     0    14 0     0]
 [    0     0     1     7     6  2762     0     0     1     0     1     2 2     0]
 [    0     3     0     1     1     1 20092     6     2     0    18     5 2     3]
 [    0     0     0     1     0     0     0  2040    15     2     1     8 3     0]
 [    0     1     0     0     0     0     0     4  1538     3     0     0 6     0]
 [    0     0     0     0     0     0     0     2     1  1770    19     0 3     0]
 [    0     0     0     0     0     1     1     0     4    10  9440     4 1     0]
 [    0     0     0     1    11     0     0     1     8     0     5  1353 1     0]
 [    0     0     0     1     1     0     0     5    41    17    39    11 2630     0]
 [    0     0     0     1     0     0     4     0     2     6    38     1 2 19651]]
accuracy 0.9944565635827024
total 77498 77930

[0.98609179, 0.99480519, 0.9960452 , 0.99831526, 0.9828614 ,
       0.99281093, 0.99791398, 0.98550725, 0.99097938, 0.98607242,
       0.99778036, 0.98043478, 0.95810565, 0.99725958]

34.6 s
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 502    0    0    3    0    5    0    0    0    0    0    1    0    0]
 [   0  364    0    0    0    0    0    0    2    0    0    4    0    0]
 [   0    0  456    0    0    2    0    1    0    0    0    0    0    0]
 [   0    1    1 2404    1    3    0    0    0    1    1    0    1    0]
 [   0    5    0    1  355    0    0    0    0    0    0    9    0    0]
 [   0    0    0    0    1  658    0    0    0    0    0    0    0    0]
 [   0    1    0    2    2    0 4958    1    0    0    4    0    2    2]
 [   0    0    0    2    0    0    0  529    3    1    2    3    0    0]
 [   0    0    0    0    0    0    0    3  342    1    2    0    0    0]
 [   0    0    0    0    0    0    0    0    1  432    7    2    2    0]
 [   0    0    0    0    0    0    1    0    1    2 2393    1    0    0]
 [   0    1    0    0    3    2    0    1    1    0    2  335    1    0]
 [   0    0    0    0    0    1    0    2   13    1    6    4  680    0]
 [   0    0    0    0    0    0    3    0    0    0   10    0    1 4932]]
accuracy 0.9926602679258841
total 19340 19483

[0.98238748, 0.98378378, 0.99346405, 0.9962702 , 0.95945946,
       0.99848255, 0.99718423, 0.97962963, 0.98275862, 0.97297297,
       0.99791493, 0.96820809, 0.96181047, 0.99716943]

cbnn1 re
7799 [10,   779] loss: 0.061
..\data\out\model_exp_cbnn1_d0.5_0.4_re_7800.pth
Finished Training
Wall time: 29min 7s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2052     5     4    16     5    22     2     9     2     2     3     2 0     2]
 [    7  1471     4     2    12     1     3     3     3     2     0     4 0     0]
 [    7     1  1780    14     2     5     1     0     0     1     4     2 0     0]
 [   36     6    16  9410     1    35    14     7     0     4    17     2 4    10]
 [    0     9     1     0  1335     9     0     1     3     0     0    46 1     0]
 [    8     0     6    18     6  2693     1     0     0     1     3     3 12     0]
 [   15     4     5    34     1    11 19944    13     0     2    11     6 3    11]
 [   45     1     2    11     2     5     2  1947     7     3    28     4 21     1]
 [    5     3     1     2     3     2     0     5  1476     4     5     8 17     0]
 [    2     1     4     0     2     2     0    14     7  1752    23     1 9     1]
 [   16     2     6    33     1     7    16    70     8    26  9288     9 39    11]
 [    1     2     1     2   101     6     0     3    13     1     4  1248 15     0]
 [    5     1     2     5     6    39     3    21    23    16    28     3 2589     1]
 [    5     3     1    27     0     0     3     7     1     3    30     0 5 19513]]
accuracy 0.9816245348389581
total 76498 77930

[0.96519285, 0.9728836 , 0.97963676, 0.98410374, 0.95017794,
       0.97891676, 0.99421735, 0.93650794, 0.96407577, 0.96369637,
       0.97440201, 0.89334288, 0.94420131, 0.99566282]


     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 528    0    0    5    0    3    2    3    0    0    1    0    0    0]
 [   1  389    2    1    0    0    1    1    1    0    0    2    0    0]
 [   0    0  405    2    0    2    2    0    0    0    0    1    0    0]
 [   3    0    0 2319    0    5    6    3    0    3    4    1    1    3]
 [   1    1    0    0  297    2    0    0    0    0    0    5    1    0]
 [   0    0    0    2    0  682    0    0    0    0    0    0    6    0]
 [   0    0    0    0    0    0 5044    0    0    0    0    0    0    2]
 [   3    1    0    0    0    0    0  512    2    2    7    0    4    0]
 [   0    1    0    0    0    0    0    0  358    1    1    1    7    0]
 [   0    0    0    0    0    0    0    2    1  410    7    0    1    0]
 [   1    0    0    0    0    0    2    6    0    4 2307    1    3    3]
 [   1    0    0    0   23    2    0    0    5    0    4  289    5    0]
 [   0    0    0    0    0    3    0    3    4    5   10    2  681    2]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 5053]]
accuracy 0.9892726992762921
total 19274 19483

[0.97416974, 0.97738693, 0.98300971, 0.98764906, 0.96742671,
       0.9884058 , 0.99960365, 0.96421846, 0.9701897 , 0.97387173,
       0.99140524, 0.87841945, 0.95915493, 1.        ]

cbnn1_d0.5_0.4_rc
7799 [10,   779] loss: 0.072
..\data\out\model_exp_cbnn1_d0.5_0.4_rc_7800.pth
Finished Training
Wall time: 26min 23s

1min 35s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2012    12    11    37     4    27     6    15     0     2     4     0 6     3]
 [   12  1435     8     6     9     4     5     3     4     1     0     6 0     0]
 [    4     0  1734    21     4     9     1     0     0     1     2     0 1     0]
 [   28     2    30  9361     2    31    15     3     1     3    12     3 4    15]
 [    3    18     5     2  1269    15     1     1     3     0     0    66 2     0]
 [    9     2     6    30     2  2675     6     1     2     0     2     0 21     0]
 [    7     2     0    30     3     8 20098     6     1     1    16     5 4    14]
 [   55     1     1    18     1     1    18  1896    14    19    47     3 32     2]
 [    2     2     1     2     7     3     0     4  1429     6     6     6 51     0]
 [    0     0     4     2     1     0     0    13     4  1714    38     1 21     5]
 [   24     1     6    35     1     0    16    45     9    34  9148     7 43    42]
 [    1     0     0     1    93     9     0     3    20     2     9  1247 12     0]
 [    6     1     1     6     1    40     1    10    23     9    52     4 2579     3]
 [    2     0     1    10     0     0     1     0     0     1    15     0 4 19667]]
accuracy 0.9786218401129219
total 76264 77930

[0.94062646, 0.96115204, 0.97580191, 0.98433228, 0.91624549,
       0.97060958, 0.99519683, 0.89943074, 0.94075049, 0.95063783,
       0.97205398, 0.89262706, 0.94261696, 0.9982742 ]

41.7 s
   0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 516    0    0    3    0    4    0    4    0    0    1    0    1    0]
 [   2  408    0    0    2    0    2    1    1    0    0    1    0    0]
 [   0    0  447    0    0    3    0    0    0    1    1    0    0    0]
 [   2    0    1 2375    0    0    8    0    0    1    3    0    2    8]
 [   0    3    0    0  310    2    0    0    0    0    0   11    1    0]
 [   2    0    0    3    0  675    0    0    0    0    0    0    5    0]
 [   0    0    0    0    0    0 4910    0    0    0    0    0    0    1]
 [   5    0    0    1    0    0    2  480    1    1    5    0    6    1]
 [   0    0    0    1    0    0    0    0  367    3    1    1    8    0]
 [   0    0    0    0    0    1    0    0    0  428    5    0    2    0]
 [   0    0    1    0    0    0    4    3    0    0 2428    2    5    5]
 [   0    0    0    0   22    0    0    0    1    0    3  299    4    0]
 [   0    0    0    0    0    1    1    2    3    1    7    1  700    0]
 [   0    0    0    0    0    0    1    0    0    1    0    0    0 4948]]
accuracy 0.9901452548375507
total 19291 19483

[0.97542533, 0.97841727, 0.98893805, 0.98958333, 0.94801223,
       0.98540146, 0.99979638, 0.9561753 , 0.96325459, 0.98165138,
       0.99183007, 0.90881459, 0.97765363, 0.99959596]

cbnn1_d0.5_0.4_rc
7799 [10,   779] loss: 0.038
..\data\out\model_exp_cbnn1_d0.5_0.4_rc_7800.pth
Finished Training
Wall time: 24min 15s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2079     1     4    40     1     8     0     1     0     0     1     1 0     0]
 [    9  1499     3     0     3     1     1     4     4     0     0     7 0     0]
 [    9     1  1782    10     4     7     0     0     0     0     3     0 0     0]
 [   24     3     2  9482     1     9     1     1     1     1     0     3 2     2]
 [    3     4     1     1  1335     4     0     4     1     1     0    37 0     0]
 [    8     2     2    18     2  2741     1     0     1     0     2     2 0     0]
 [    2     9     1     8     0     1 20014     2     1     0     7     1 4     7]
 [    7     0     1     6     3     0     1  2073     9     4    17     2 7     0]
 [    0     7     0     2     2     0     0    15  1449     4     5     5 27     0]
 [    0     0     0     0     0     0     3     3     3  1726    54     0 16     5]
 [    0     0     0     0     0     1     3     7     1     8  9404    12 10     6]
 [    0     2     0     0    55     2     0     2     6     2    12  1277 11     0]
 [    0     1     0     2     0     5     0    13    16     9    53     2 2674     1]
 [    1     0     0     3     0     0     2     7     0     0    23     0 3 19596]]
accuracy 0.9897472090337482
total 77131 77930

[0.97331461, 0.97909863, 0.98127753, 0.99475451, 0.95974119,
       0.98632602, 0.99785611, 0.97323944, 0.95580475, 0.95359116,
       0.99492171, 0.93279766, 0.96325648, 0.99801375]


     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 517    0    0    8    0    4    0    2    0    0    0    1    0    0]
 [   1  374    1    0    0    0    0    0    2    0    0    0    1    0]
 [   1    1  406    2    0    3    0    0    0    0    0    0    0    0]
 [   4    2    0 2369    0    2    0    0    0    0    0    1    0    0]
 [   0    0    1    0  308    1    0    0    0    0    0   11    0    0]
 [   0    1    0    1    2  655    0    0    0    0    0    0    3    0]
 [   0    3    0    1    1    0 5040    0    0    0    1    1    1    1]
 [   0    0    0    1    1    0    1  470    0    0    2    0    5    0]
 [   0    1    0    1    0    0    0    3  369    0    2    0    8    0]
 [   0    0    0    0    0    0    0    0    0  421    6    0    2    0]
 [   0    0    0    1    0    0    1    0    1    0 2402    0    0    2]
 [   0    0    0    0   16    1    0    1    0    0    3  332    4    0]
 [   0    0    0    0    1    1    0    3    4    1   10    4  651    1]
 [   0    0    0    1    0    0    1    1    0    0    6    0    0 5007]]
accuracy 0.9916850587691833
total 19321 19483

cbnn3_d0.5_0.4_rc
7799 [10,   779] loss: 0.040
..\data\out\model_exp_cbnn3_d0.5_0.4_rc_7800.pth
Finished Training
Wall time: 37min 9s

Wall time: 2min 10s
   0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2073     6     5    31     1    12     1     1     1     1     2     1
      1     0]
 [    7  1499     3     1    13     0     0     1     3     0     0     2
      2     0]
 [    3     2  1800     4     3     3     0     1     0     0     0     0
      0     0]
 [   16     6     5  9466     5    16     1     1     0     4     6     2
      2     2]
 [    1     7     9     1  1337     6     0     1     0     0     0    29
      0     0]
 [    8     0     6    14     3  2739     0     0     2     0     3     2
      2     0]
 [    0     4     0     1     0     0 20028     0     0     0     5     2
      0    17]
 [    5     1     2     7     2     0     6  2055    13     2    13     3
     21     0]
 [    0     9     0     1     5     0     0     4  1463     8     3     3
     19     1]
 [    0     0     0     0     0     0     1     1     4  1746    41     1
      9     7]
 [    0     0     0     1     0     1     8     4     1    15  9365     5
     12    40]
 [    0     5     0     0    84     4     0     2    11     6     9  1236
     12     0]
 [    2     1     0     2     1     2     2     4    10    18    37     2
   2690     5]
 [    0     0     0     3     0     1     0     1     0     0    10     0
      0 19620]]
accuracy 0.9895675606313358
total 77117 77930

[0.97050562, 0.97909863, 0.99118943, 0.99307595, 0.96117901,
       0.98560633, 0.99855412, 0.96478873, 0.96503958, 0.96464088,
       0.9907956 , 0.90284879, 0.96902017, 0.99923606]


     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 521    0    0    5    0    5    0    0    0    0    1    0    0    0]
 [   1  372    0    1    1    0    0    0    1    0    0    3    0    0]
 [   0    0  405    4    1    2    0    0    0    0    0    1    0    0]
 [   4    0    0 2369    0    1    0    0    0    0    3    0    1    0]
 [   1    2    1    1  308    1    0    0    0    0    0    7    0    0]
 [   0    0    0    3    0  656    0    0    0    0    0    2    1    0]
 [   0    1    0    0    0    0 5044    0    0    0    0    0    1    3]
 [   0    0    0    4    2    0    2  468    0    0    1    1    2    0]
 [   0    1    0    1    0    0    0    1  377    0    0    0    4    0]
 [   0    0    0    0    0    0    0    0    0  424    2    0    3    0]
 [   0    0    0    0    0    0    1    1    0    3 2394    0    3    5]
 [   0    0    0    0   19    3    0    0    2    0    2  327    4    0]
 [   0    0    0    0    0    0    0    2    0    4    9    0  660    1]
 [   0    0    0    0    0    0    0    0    0    0    3    0    0 5013]]
accuracy 0.9925576143304419
total 19338 19483

0.97932331, 0.98153034, 0.98062954, 0.99621531, 0.95950156,
       0.99093656, 0.9990097 , 0.975     , 0.98177083, 0.98834499,
       0.99459909, 0.91596639, 0.97633136, 0.99940191]


cbnn3_d0.5_0.4_rc_re
..\data\out\model_exp_cbnn3_d0.5_0.4_rc_re_7800.pth
Finished Training
Wall time: 37min 52s

Wall time: 2min 14s
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2016     4     2    51     4    17     1    19     2     1     9     0
      1     3]
 [   10  1468     2    13     9     0     1     1     3     0     0     6
      0     0]
 [    4     1  1718    19     2     9     1     1     1     1     3     0
      3     0]
 [   17     4    10  9437     2    15    11     3     0     4    21     1
      7    33]
 [    1    11     1     4  1287    13     0     0     5     1     0    67
      1     0]
 [   14     3     3    33    10  2695     2     2     1     0     0     9
     28     0]
 [    3     1     1    18     0     2 20003     3     2     2    11     2
      2    28]
 [   39     1     0    14     0     3     7  1910     7    12    35     5
     30     1]
 [    1     2     0     0     3     3     1     7  1451    12     3    11
     29     0]
 [    0     0     0     5     3     0     1     2     6  1687    51     2
     13     5]
 [    5     2     2    37     0     1    12    25     5    18  9320     6
     24    56]
 [    1     3     0     1    71    13     0     2    16     3     6  1240
     12     2]
 [    4     0     0     8     1    18     2    10    19    12    49     5
   2638     7]
 [    2     0     0    13     0     0     1     0     0     3    14     0
      1 19638]]
accuracy 0.9817528551263954
total 76508 77930

[0.94647887, 0.97025777, 0.97447533, 0.98661788, 0.92523364,
       0.9625    , 0.99626457, 0.9253876 , 0.95272489, 0.95042254,
       0.97971197, 0.90510949, 0.95131626, 0.99827166]


     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 523    0    1    5    0    2    1    6    0    0    0    0    0    0]
 [   1  389    0    2    2    0    0    0    1    0    0    1    1    0]
 [   1    0  455    5    0    1    0    0    0    0    1    0    2    1]
 [   0    1    0 2330    0    0    4    0    0    1    5    0    0    4]
 [   1    0    0    1  284    4    0    0    0    0    0   30    0    1]
 [   2    0    1    3    0  628    1    0    0    0    0    0    6    0]
 [   0    0    0    0    0    0 5028    0    0    0    0    0    0    0]
 [   4    0    0    2    0    0    2  527    0    1    6    1    3    0]
 [   0    0    0    0    0    0    0    1  373    0    0    0    3    0]
 [   0    0    0    0    0    0    0    0    0  456    5    0    3    0]
 [   0    0    0    0    0    0    0    2    1    3 2334    1    1    4]
 [   0    0    0    0   13    2    0    1    4    0    0  332    4    0]
 [   0    0    0    0    0    2    0    2    3    5    9    0  657    1]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4979]]
accuracy 0.9903505620284351
total 19295 19483

[0.97211896, 0.97984887, 0.97639485, 0.99360341, 0.8847352 ,
       0.97971919, 1.        , 0.96520147, 0.98938992, 0.98275862,
       0.99488491, 0.93258427, 0.96759941, 1.        ]

cbnn3_d0.5_0.4_re
7799 [10,   779] loss: 0.058
..\data\out\model_exp_cbnn3_d0.5_0.4_re_7800.pth
Finished Training
Wall time: 39min 30s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2078     4     0    37     2    18     4    34     2     0     4     0
      4     0]
 [    4  1480     0     6    10     0     1     1     2     0     1     5
      0     0]
 [    2     2  1725    34     2     8     0     0     1     0     2     1
      1     0]
 [   18     5     8  9432     0    18    19     5     0     7    21     2
      2    15]
 [    1     7     1     0  1320    15     0     0     1     0     0    47
      0     0]
 [    4     2     5    19    10  2707     0     0     1     0     2     5
     16     0]
 [    2     3     0     4     0     1 20057     5     0     0    13     1
      2     1]
 [   21     1     0    15     0     2     9  1983     7     4    33     5
     24     0]
 [    3     3     1     0     4     1     1     7  1442     6     2     9
     27     0]
 [    1     0     2     0     1     0     2     5     6  1699    25     2
     20     0]
 [    4     2     2    36     0     0    26    33     3    20  9303     3
     30     4]
 [    1     3     1     0    82     5     1     2    10     1     5  1276
      1     0]
 [    4     1     1     5     4    24     2    16    16    19    35     6
   2629     0]
 [    2     0     0    17     1     0    16     2     0     5    30     1
      4 19584]]
accuracy 0.9844090850763506
total 76715 77930

[0.95016004, 0.98013245, 0.97019123, 0.98743719, 0.94827586,
       0.97690364, 0.99840709, 0.94249049, 0.95750332, 0.96369824,
       0.98278048, 0.91930836, 0.95184649, 0.99603296]


    0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 472    0    0    1    0    2    0    6    0    0    0    0    0    0]
 [   4  392    0    0    1    0    1    0    0    0    0    2    0    0]
 [   0    0  442    1    1    3    0    0    1    1    1    0    1    0]
 [   2    0    0 2337    0    1    8    1    0    1    6    0    0    2]
 [   0    1    0    1  302    0    0    0    0    0    0   16    0    0]
 [   2    0    0    4    1  662    0    1    0    0    0    0    0    0]
 [   1    1    0    0    0    0 5013    0    0    0    1    0    0    1]
 [   5    0    0    0    0    0    2  482    2    3    7    0    4    1]
 [   0    2    0    0    1    0    0    2  384    0    0    2    3    0]
 [   0    0    0    0    0    0    2    2    2  459    8    0    3    0]
 [   0    0    0    1    0    0    2    0    0    2 2380    1    6    1]
 [   0    0    0    0   10    2    0    0    5    0    3  316    2    0]
 [   0    0    0    1    0    2    0    4    2    3    2    1  674    1]
 [   0    0    0    0    0    0    2    0    0    0    1    0    0 4986]]
accuracy 0.9906585228147616
total 19301 19483

cbnn1_last_bn
7799 [10,   779] loss: 0.003
..\data\out\model_exp_cbnn1_last_bn7800.pth
Finished Training
Wall time: 30min 38s

device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (batch1): BatchNorm2d(6, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (drop1): Dropout(p=0.5, inplace=False)
  (fc1): Linear(in_features=2704, out_features=120, bias=True)
  (drop2): Dropout(p=0.4, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)

7799 [10,   779] loss: 0.003
..\data\out\model_exp_cbnn1_last_bn7800.pth
Finished Training
Wall time: 30min 38s

     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2108     1     0     3     0     2     0     0     0     0     0     0
      0     0]
 [    0  1543     0     0     1     0     0     0     0     0     0     0
      0     0]
 [    0     0  1750     2     0     0     0     0     0     0     0     0
      0     0]
 [    2     0     2  9562     0     0     0     0     0     0     0     0
      0     0]
 [    0     1     0     0  1373     0     0     0     0     0     0     4
      0     0]
 [    0     0     0     0     0  2783     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0 20042     0     0     0     0     0
      0     1]
 [    0     0     0     0     0     0     0  2098     2     0     0     1
      1     0]
 [    0     0     0     0     0     0     0     1  1506     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0  1776     6     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     0  9380     0
      0     0]
 [    0     0     0     0     0     1     0     0     0     0     0  1394
      0     0]
 [    0     0     0     0     0     0     0     0     5     0     0     0
   2796     0]
 [    0     0     0     0     0     0     0     0     0     0     1     0
      0 19782]]
accuracy 0.9995252149364815
total 77893 77930

[0.99716178, 0.99935233, 0.99885845, 0.99958185, 0.99637155,
       1.        , 0.99995011, 0.99809705, 0.99933643, 0.996633  ,
       1.        , 0.99928315, 0.99821492, 0.99994945]

1min 44s

36.3 s
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 553    0    0    1    0    0    0    0    0    0    0    0    0    0]
 [   0  365    0    0    0    0    0    0    0    0    0    1    0    0]
 [   0    0  476    1    0    0    0    0    0    0    0    0    0    0]
 [   1    1    0 2341    0    1    0    0    0    0    0    0    0    0]
 [   0    1    0    0  331    1    0    0    0    0    0    1    0    0]
 [   0    0    0    0    0  658    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 5062    0    0    0    1    0    0    0]
 [   0    0    0    0    0    0    0  505    1    0    1    1    0    0]
 [   0    0    0    0    0    0    0    3  389    0    0    0    1    0]
 [   0    0    0    0    0    0    0    1    1  451    4    0    0    0]
 [   0    0    0    0    0    0    0    1    0    0 2476    1    1    0]
 [   0    0    0    0    0    0    0    0    2    0    2  327    0    0]
 [   1    0    0    0    0    0    0    0    3    0    2    0  644    1]
 [   0    0    0    0    0    0    0    0    0    0    2    0    0 4866]]
accuracy 0.9979982548888775
total 19444 19483

[0.99819495, 0.99726776, 0.99790356, 0.99872014, 0.99101796,
       1.        , 0.99980249, 0.99409449, 0.98982188, 0.9868709 ,
       0.99878983, 0.98791541, 0.98924731, 0.99958915]


pil yasser
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 179    0    0    2    0    0    0    0    0    0    0    0    0    0]
 [   0  176    0    0    0    0    0    0    0    0    0    1    0    0]
 [   0    0  208    0    0    0    0    0    0    0    0    0    0    0]
 [   0    1    2 1031    0    1    0    0    0    0    0    0    0    0]
 [   0    2    0    0  121    1    0    0    0    0    0    1    0    0]
 [   0    0    0    0    0  269    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4390    0    0    0    1    0    0    0]
 [   0    0    0    0    0    0    0  194    1    0    0    1    0    0]
 [   0    0    0    0    0    0    0    4  173    0    0    0    0    0]
 [   0    0    0    0    0    0    0    1    1  200    1    0    0    0]
 [   0    0    0    0    0    0    0    1    0    0 1031    1    1    0]
 [   0    0    0    0    0    0    0    0    2    0    2  129    0    0]
 [   1    0    0    0    0    0    0    0    0    0    1    0  268    1]
 [   0    0    0    0    0    0    0    0    0    0    3    0    0 4400]]
accuracy 0.9973443724127158
total 12769 12803

[0.98895028, 0.99435028, 1.        , 0.99613527, 0.968     ,
       1.        , 0.99977226, 0.98979592, 0.97740113, 0.98522167,
       0.99709865, 0.96992481, 0.98892989, 0.99931865]


exp_cbnn1_d0.5_0.4_bn_rc
device cpu
Net(
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv1): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (batch1): BatchNorm2d(6, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (drop1): Dropout(p=0.5, inplace=False)
  (fc1): Linear(in_features=2704, out_features=120, bias=True)
  (drop2): Dropout(p=0.4, inplace=False)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=14, bias=True)
)
7799 [10,   779] loss: 0.005
torchvision.transforms.Grayscale(),
                                            torchvision.transforms.Resize((64, 64)),
                                            GaussianSmoothing([0, 0.5]),
                                            torchvision.transforms.RandomApply([
                                              torchvision.transforms.RandomResizedCrop((64, 64), scale=(0.8, 1.0), ratio=(0.9, 1.1)),
                                            ], p=0.75),
                                            torchvision.transforms.ToTensor(),
#                                             torchvision.transforms.RandomErasing(p=0.30, scale=(0.05, 0.2)),
#                                             torchvision.transforms.Normalize((0.5, ), (0.5, ))
])

7799 [10,   779] loss: 0.005

23399 [30,   779] loss: 0.002
..\data\out\model_exp_cbnn1_d0.5_0.4_bn_rc23400.pth
Finished Training
Wall time: 1h 45min 36s

aagard 23400
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1113    0    0    0   14    0    0    4    0    0    0    0    0    1]
 [   1  701    0    0    0    0    0    2    0    0    0   11    0    0]
 [   5    0  902   11    2    1    0    0    0    0    0    0    0    0]
 [   0    0    5 1175    0    1    7    0    0    2    0    0    0    0]
 [   0    0    1    1  724    0    0    0    0    0    0    0    0    0]
 [   1    0    1    2    0 1008    0    0    1    0    0    1    0    0]
 [   1    0    0    1    0    0 1081    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    1 1005    5    0    1    0    0    0]
 [   0    1    0    0    0    1    0   19  756    0    0   21   16    0]
 [   0    0    0    0    0    0    0    1    0  900    1    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1032    0    0    0]
 [   0    4    0    0    6    0    0    0    0    0    0  755    0    0]
 [   0    0    0    0    0    0    0    0    3    0    0    0 1010    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 1093]]
accuracy 0.9882940650164033
total 13255 13412
[0.98321555, 0.98041958, 0.97937025, 0.98739496, 0.99724518,
       0.99408284, 0.99815328, 0.993083  , 0.92874693, 0.99778271,
       1.        , 0.9869281 , 0.9970385 , 1.        ]


aagard 7799
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[1079    1    0    0   46    0    0    5    0    0    0    0    0    1]
 [   1  689    0    0    0    1    0    4    1    0    0   19    0    0]
 [   5    0  898   17    1    0    0    0    0    0    0    0    0    0]
 [   0    0    0 1172    0    1   17    0    0    0    0    0    0    0]
 [   0    0    0    2  724    0    0    0    0    0    0    0    0    0]
 [   1    0    0    2    0 1009    0    1    0    0    0    1    0    0]
 [   2    0    0    0    0    0 1080    1    0    0    0    0    0    0]
 [   0    0    0    0    0    0    1 1006    3    0    1    1    0    0]
 [   0    1    0    0    0    1    0   44  685    0    0   40   43    0]
 [   0    0    0    0    0    0    0    1    0  896    5    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 1032    0    0    0]
 [   0    2    0    0    6    0    0    1    0    0    0  756    0    0]
 [   0    0    0    0    0    0    0    0    2    0    0    2 1009    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 1093]]
accuracy 0.9788249328959141
total 13128 13412

[0.95318021, 0.96363636, 0.97502714, 0.98487395, 0.99724518,
       0.99506903, 0.99722992, 0.99407115, 0.84152334, 0.99334812,
       1.        , 0.98823529, 0.99605133, 1.        ]

23400 0.2
     0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 559    0    0    1    0    0    0    0    0    0    0    0    0    0]
 [   0  380    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0  441    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 2411    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0  349    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0  695    0    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4952    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0  529    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0  366    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0    0  464    1    0    0    0]
 [   0    0    0    0    0    0    0    0    0    0 2356    1    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0  376    0    0]
 [   0    0    0    0    0    0    0    0    1    0    0    0  712    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 4889]]
accuracy 0.9997946928091156
total 19479 19483
[0.99821429, 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 0.99784946,
       0.99957573, 1.        , 0.99859748, 1.        ]

23400 0.8
   0    1    2    3    4    5    6    7    8    9   10   11   12   13
[[ 2107     0     0     0     0     1     0     0     0     0     0     0
      0     0]
 [    0  1529     0     0     1     0     0     0     0     0     0     0
      0     0]
 [    0     0  1787     1     0     0     0     0     0     0     0     0
      0     0]
 [    1     0     0  9498     0     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     0  1363     0     0     0     0     0     0     0
      0     0]
 [    0     0     0     1     0  2745     0     0     0     0     0     0
      0     0]
 [    0     0     0     0     0     0 20153     0     0     0     1     0
      0     0]
 [    0     0     0     0     0     0     0  2078     2     0     0     0
      1     0]
 [    0     0     0     0     0     0     0     0  1534     0     0     0
      0     0]
 [    0     0     0     0     0     0     0     0     0  1771     3     0
      0     0]
 [    0     0     0     0     0     0     0     0     0     8  9493     1
      0     0]
 [    0     0     0     0     0     0     0     0     0     0     0  1350
      0     0]
 [    0     0     0     0     0     0     0     0     5     0     1     0
   2733     0]
 [    0     0     0     0     0     0     0     0     0     0     0     1
      0 19761]]
accuracy 0.9996407031951752
total 77902 77930
[0.99952562, 0.99934641, 0.99944072, 0.99989473, 1.        ,
       0.99963583, 0.99995038, 0.99855839, 1.        , 0.99830891,
       0.99905283, 1.        , 0.99780942, 0.9999494 ]


7799 0.8

7799 0.2